<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Yet another study guide for ‘R for Data Science’</title>
  <meta name="description" content="Notes and solutions to Garrett Grolemund and Hadley Wickham’s ‘R for Data Science’">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Yet another study guide for ‘R for Data Science’" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://brshallo.github.io/R4DS_Solutions/" />
  
  <meta property="og:description" content="Notes and solutions to Garrett Grolemund and Hadley Wickham’s ‘R for Data Science’" />
  <meta name="github-repo" content="https://github.com/brshallo/R4DS_Solutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Yet another study guide for ‘R for Data Science’" />
  <meta name="twitter:site" content="@brshallo" />
  <meta name="twitter:description" content="Notes and solutions to Garrett Grolemund and Hadley Wickham’s ‘R for Data Science’" />
  

<meta name="author" content="Bryan Shalloway">


<meta name="date" content="2019-06-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="20-vectors.html">
<link rel="next" href="23-model-basics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.3.1/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Yet another study guide to R4DS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Purpose of book</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization-and-features-of-book"><i class="fa fa-check"></i>Organization and features of book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#origin-of-book"><i class="fa fa-check"></i>Origin of book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html"><i class="fa fa-check"></i>Ch 3: Data visualization</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#first-steps"><i class="fa fa-check"></i>3.2: First steps</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section"><i class="fa fa-check"></i>3.2.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#aesthetic-mappings"><i class="fa fa-check"></i>3.3: Aesthetic mappings</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-1"><i class="fa fa-check"></i>3.3.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#facets"><i class="fa fa-check"></i>3.5: Facets</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-2"><i class="fa fa-check"></i>3.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#geometric-objects"><i class="fa fa-check"></i>3.6: Geometric Objects</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-3"><i class="fa fa-check"></i>3.6.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#statistical-transformations"><i class="fa fa-check"></i>3.7: Statistical transformations</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-4"><i class="fa fa-check"></i>3.7.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#position-adjustment"><i class="fa fa-check"></i>3.8: Position Adjustment</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-5"><i class="fa fa-check"></i>3.8.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#coordinate-systems"><i class="fa fa-check"></i>3.9: Coordinate systems</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#section-6"><i class="fa fa-check"></i>3.9.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#appendix"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="03-data-visualization.html"><a href="03-data-visualization.html#extension"><i class="fa fa-check"></i>3.7.1.1 extension</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html"><i class="fa fa-check"></i>Ch. 5: Data transformations</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#filter-rows"><i class="fa fa-check"></i>5.2: Filter rows</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-7"><i class="fa fa-check"></i>5.2.4.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#arrange-rows"><i class="fa fa-check"></i>5.3: Arrange rows</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-8"><i class="fa fa-check"></i>5.3.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#select-columns"><i class="fa fa-check"></i>5.4: Select columns</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-9"><i class="fa fa-check"></i>5.4.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#add-new-vars"><i class="fa fa-check"></i>5.5: Add new vars</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-10"><i class="fa fa-check"></i>5.5.2.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#grouped-summaries"><i class="fa fa-check"></i>5.6: Grouped summaries…</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-11"><i class="fa fa-check"></i>5.6.7.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#grouped-mutates"><i class="fa fa-check"></i>5.7: Grouped mutates…</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-12"><i class="fa fa-check"></i>5.7.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#appendix-1"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-13"><i class="fa fa-check"></i>5.4.1.3.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-14"><i class="fa fa-check"></i>5.5.2.1.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-15"><i class="fa fa-check"></i>5.5.2.2.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-16"><i class="fa fa-check"></i>5.6.7.1.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-18"><i class="fa fa-check"></i>5.6.7.4.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-19"><i class="fa fa-check"></i>5.6.7.5.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-20"><i class="fa fa-check"></i>5.6.7.6.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-21"><i class="fa fa-check"></i>5.7.1.6.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-22"><i class="fa fa-check"></i>5.7.1.5</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#section-23"><i class="fa fa-check"></i>5.7.1.8.</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#on-piping-dots"><i class="fa fa-check"></i>On piping dots</a></li>
<li class="chapter" data-level="" data-path="05-data-transformations.html"><a href="05-data-transformations.html#plotly"><i class="fa fa-check"></i>plotly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html"><i class="fa fa-check"></i>Ch. 7: Data exploration</a><ul>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#variation"><i class="fa fa-check"></i>7.3: Variation</a><ul>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-24"><i class="fa fa-check"></i>7.3.4.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#missing-values"><i class="fa fa-check"></i>7.4: Missing values</a><ul>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-25"><i class="fa fa-check"></i>7.4.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#covariation"><i class="fa fa-check"></i>7.5: Covariation</a><ul>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-26"><i class="fa fa-check"></i>7.5.1.1.</a></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-27"><i class="fa fa-check"></i>7.5.2.1.</a></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-28"><i class="fa fa-check"></i>7.5.3.</a></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-29"><i class="fa fa-check"></i>7.5.3.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#appendix-2"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-30"><i class="fa fa-check"></i>7.5.2.1.2.</a></li>
<li class="chapter" data-level="" data-path="07-exploratory-data-analysis.html"><a href="07-exploratory-data-analysis.html#section-31"><i class="fa fa-check"></i>7.5.3.1.4.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="10-tibbles.html"><a href="10-tibbles.html"><i class="fa fa-check"></i>Ch. 10: Tibbles</a><ul>
<li class="chapter" data-level="" data-path="10-tibbles.html"><a href="10-tibbles.html#exercises"><i class="fa fa-check"></i>10.5: Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-data-import.html"><a href="11-data-import.html"><i class="fa fa-check"></i>Ch. 11: Data import</a><ul>
<li class="chapter" data-level="" data-path="11-data-import.html"><a href="11-data-import.html#getting-started"><i class="fa fa-check"></i>11.2: Getting started</a><ul>
<li class="chapter" data-level="" data-path="11-data-import.html"><a href="11-data-import.html#section-32"><i class="fa fa-check"></i>11.2.2.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-data-import.html"><a href="11-data-import.html#parsing-a-vector"><i class="fa fa-check"></i>11.3: Parsing a vector</a><ul>
<li class="chapter" data-level="" data-path="11-data-import.html"><a href="11-data-import.html#section-33"><i class="fa fa-check"></i>11.3.5.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html"><i class="fa fa-check"></i>ch. 12: Tidy data</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#tidy-data"><i class="fa fa-check"></i>12.2: Tidy data</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#section-34"><i class="fa fa-check"></i>12.2.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#spreading-and-gathering"><i class="fa fa-check"></i>12.3: Spreading and gathering</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#section-35"><i class="fa fa-check"></i>12.3.3.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#separating-and-uniting"><i class="fa fa-check"></i>12.4: Separating and uniting</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#section-36"><i class="fa fa-check"></i>12.4.3.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#missing-values-1"><i class="fa fa-check"></i>12.5: Missing values</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#section-37"><i class="fa fa-check"></i>12.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#case-study"><i class="fa fa-check"></i>12.6 Case Study</a><ul>
<li class="chapter" data-level="" data-path="12-tidy-data.html"><a href="12-tidy-data.html#section-38"><i class="fa fa-check"></i>12.6.1.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html"><i class="fa fa-check"></i>Ch. 13: Relational data</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#nycflights13"><i class="fa fa-check"></i>13.2 nycflights13</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#section-39"><i class="fa fa-check"></i>13.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#keys"><i class="fa fa-check"></i>13.3 Keys</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#section-40"><i class="fa fa-check"></i>13.3.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#mutating-joins"><i class="fa fa-check"></i>13.4 Mutating joins</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#section-41"><i class="fa fa-check"></i>13.4.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#filtering-joins"><i class="fa fa-check"></i>13.5 Filtering joins</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#section-42"><i class="fa fa-check"></i>13.5.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#appendix-3"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="13-relational-data.html"><a href="13-relational-data.html#section-43"><i class="fa fa-check"></i>13.5.1.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html"><i class="fa fa-check"></i>Ch. 14: Strings</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#string-basics"><i class="fa fa-check"></i>14.2: String basics</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-44"><i class="fa fa-check"></i>14.2.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#matching-patterns-w-regex"><i class="fa fa-check"></i>14.3: Matching patterns w/ regex</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-45"><i class="fa fa-check"></i>14.3.1.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-46"><i class="fa fa-check"></i>14.3.2.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-47"><i class="fa fa-check"></i>14.3.3.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-48"><i class="fa fa-check"></i>14.3.4.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-49"><i class="fa fa-check"></i>14.3.5.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#tools"><i class="fa fa-check"></i>14.4 Tools</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-50"><i class="fa fa-check"></i>14.4.2</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-51"><i class="fa fa-check"></i>14.4.3.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-52"><i class="fa fa-check"></i>14.4.4.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-53"><i class="fa fa-check"></i>14.4.5.1</a></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-54"><i class="fa fa-check"></i>14.4.6.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#other-types-of-patterns"><i class="fa fa-check"></i>14.5: Other types of patterns</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-55"><i class="fa fa-check"></i>14.5.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#stringi"><i class="fa fa-check"></i>14.7: stringi</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-56"><i class="fa fa-check"></i>14.7.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#appendix-4"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="14-strings.html"><a href="14-strings.html#section-57"><i class="fa fa-check"></i>14.4.2.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html"><i class="fa fa-check"></i>Ch. 15: Factors</a><ul>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#general-social-survey"><i class="fa fa-check"></i>15.4: General Social Survey</a><ul>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#section-58"><i class="fa fa-check"></i>15.3.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#modifying-factor-order"><i class="fa fa-check"></i>15.4: Modifying factor order</a><ul>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#section-59"><i class="fa fa-check"></i>15.4.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#modifying-factor-levels"><i class="fa fa-check"></i>15.5: Modifying factor levels</a><ul>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#section-60"><i class="fa fa-check"></i>15.5.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#appendix-5"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="15-factors.html"><a href="15-factors.html#viewing-all-levels"><i class="fa fa-check"></i>Viewing all levels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html"><i class="fa fa-check"></i>Ch. 16: Dates and times</a><ul>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#creating-datetimes"><i class="fa fa-check"></i>16.2: Creating date/times</a><ul>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-61"><i class="fa fa-check"></i>16.2.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#date-time-components"><i class="fa fa-check"></i>16.3: Date-time components</a><ul>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-62"><i class="fa fa-check"></i>16.3.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#time-spans"><i class="fa fa-check"></i>16.4: Time spans</a><ul>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-63"><i class="fa fa-check"></i>16.4.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#appendix-6"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-64"><i class="fa fa-check"></i>16.3.4.1</a></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-65"><i class="fa fa-check"></i>16.3.4.3</a></li>
<li class="chapter" data-level="" data-path="16-dates-and-times.html"><a href="16-dates-and-times.html#section-66"><i class="fa fa-check"></i>16.3.4.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="18-pipes.html"><a href="18-pipes.html"><i class="fa fa-check"></i>Ch. 18: Pipes (notes only)</a></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html"><i class="fa fa-check"></i>Ch. 19: Functions</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#when-should-you-write-a-function"><i class="fa fa-check"></i>19.2: When should you write a function?</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-67"><i class="fa fa-check"></i>19.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#functions-are-for-humans-and-computers"><i class="fa fa-check"></i>19.3: Functions are for humans and computers</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-68"><i class="fa fa-check"></i>19.3.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#conditional-execution"><i class="fa fa-check"></i>19.4: Conditional execution</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-69"><i class="fa fa-check"></i>19.4.4.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#function-arguments"><i class="fa fa-check"></i>19.5: Function arguments</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-70"><i class="fa fa-check"></i>19.5.5.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#return-values"><i class="fa fa-check"></i>19.6: Return values</a></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#appendix-7"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-71"><i class="fa fa-check"></i>19.2.1.4</a></li>
<li class="chapter" data-level="" data-path="19-functions.html"><a href="19-functions.html#section-72"><i class="fa fa-check"></i>19.2.3.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html"><i class="fa fa-check"></i>Ch. 20: Vectors</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#important-types-of-atomic-vector"><i class="fa fa-check"></i>20.3: Important types of atomic vector</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#section-73"><i class="fa fa-check"></i>20.3.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#using-atomic-vectors"><i class="fa fa-check"></i>20.4: Using atomic vectors</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#section-74"><i class="fa fa-check"></i>20.4.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#recursive-vectors-lists"><i class="fa fa-check"></i>20.5: Recursive vectors (lists)</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#section-75"><i class="fa fa-check"></i>20.5.4.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#augmented-vectors"><i class="fa fa-check"></i>20.7: Augmented vectors</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#section-76"><i class="fa fa-check"></i>20.7.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#appendix-8"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="20-vectors.html"><a href="20-vectors.html#subsetting-nested-lists"><i class="fa fa-check"></i>Subsetting nested lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html"><i class="fa fa-check"></i>Ch. 21: Iteration</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#for-loops"><i class="fa fa-check"></i>21.2: For loops</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-77"><i class="fa fa-check"></i>21.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#for-loop-variations"><i class="fa fa-check"></i>21.3 For loop variations</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-78"><i class="fa fa-check"></i>21.3.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#for-loops-vs.-functionals"><i class="fa fa-check"></i>21.4: For loops vs. functionals</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-79"><i class="fa fa-check"></i>21.4.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#the-map-functions"><i class="fa fa-check"></i>21.5: The map functions</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-80"><i class="fa fa-check"></i>21.5.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#other-patterns-of-for-loops"><i class="fa fa-check"></i>21.9 Other patterns of for loops</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-81"><i class="fa fa-check"></i>21.9.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#appendix-9"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-82"><i class="fa fa-check"></i>21.3.5.1</a></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#with-purrr"><i class="fa fa-check"></i>21.3.5.2 (with purrr)</a></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#section-83"><i class="fa fa-check"></i>21.9.3.1</a></li>
<li><a href="21-iteration.html#mirroring-keep">21.9 mirroring <code>keep</code></a></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#invoke-examples"><i class="fa fa-check"></i>invoke examples</a></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#indexing-nms-caution"><i class="fa fa-check"></i>indexing nms caution</a></li>
<li class="chapter" data-level="" data-path="21-iteration.html"><a href="21-iteration.html#in-class-notes"><i class="fa fa-check"></i>in-class notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html"><i class="fa fa-check"></i>Ch. 23: Model basics</a><ul>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#a-simple-model"><i class="fa fa-check"></i>23.2: A simple model</a><ul>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-84"><i class="fa fa-check"></i>23.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#visualising-models"><i class="fa fa-check"></i>23.3: Visualising models</a><ul>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-85"><i class="fa fa-check"></i>23.3.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#formulas-and-model-families"><i class="fa fa-check"></i>23.4: Formulas and model families</a><ul>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-86"><i class="fa fa-check"></i>23.4.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#appendix-10"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#other-model-families"><i class="fa fa-check"></i>Other model families</a></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#book-example"><i class="fa fa-check"></i>23.2 book example</a></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-87"><i class="fa fa-check"></i>23.2.1.1</a></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-88"><i class="fa fa-check"></i>23.3.3.2</a></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#tidy-grid_space"><i class="fa fa-check"></i>tidy grid_space</a></li>
<li class="chapter" data-level="" data-path="23-model-basics.html"><a href="23-model-basics.html#section-89"><i class="fa fa-check"></i>23.4.5.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html"><i class="fa fa-check"></i>Ch. 24: Model building</a><ul>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#why-are-low-quality-diamonds-more-expensive"><i class="fa fa-check"></i>24.2: Why are low quality diamonds more expensive?</a><ul>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#section-90"><i class="fa fa-check"></i>24.2.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#what-affects-the-number-of-daily-flights"><i class="fa fa-check"></i>24.3 What affects the number of daily flights?</a><ul>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#section-91"><i class="fa fa-check"></i>24.3.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#appendix-11"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#section-92"><i class="fa fa-check"></i>24.2.3.3</a></li>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#section-93"><i class="fa fa-check"></i>24.2.3.1</a></li>
<li class="chapter" data-level="" data-path="24-model-building.html"><a href="24-model-building.html#section-94"><i class="fa fa-check"></i>24.3.5.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html"><i class="fa fa-check"></i>Ch. 25: Many models</a><ul>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#gapminder"><i class="fa fa-check"></i>25.2: gapminder</a><ul>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#section-95"><i class="fa fa-check"></i>25.2.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#creating-list-columns"><i class="fa fa-check"></i>25.4: Creating list-columns</a><ul>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#section-96"><i class="fa fa-check"></i>25.4.5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#simplifying-list-columns"><i class="fa fa-check"></i>25.5: Simplifying list-columns</a><ul>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#section-97"><i class="fa fa-check"></i>25.5.3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#appendix-12"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#models-in-lists"><i class="fa fa-check"></i>Models in lists</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#list-columns-for-sampling"><i class="fa fa-check"></i>List-columns for sampling</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#section-98"><i class="fa fa-check"></i>25.2.5.1</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#multiple-graphs-in-chunk"><i class="fa fa-check"></i>Multiple graphs in chunk</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#listquantile-examples"><i class="fa fa-check"></i>list(quantile()) examples</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#extracting-names"><i class="fa fa-check"></i>Extracting names</a></li>
<li><a href="25-many-models.html#invoke_map-example-book"><code>invoke_map</code> example (book)</a></li>
<li class="chapter" data-level="" data-path="25-many-models.html"><a href="25-many-models.html#named-list-example-book"><i class="fa fa-check"></i>named list example (book)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html"><i class="fa fa-check"></i>Ch. 27: R Markdown</a><ul>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#r-markdown-basics"><i class="fa fa-check"></i>27.2 R Markdown basics</a><ul>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#section-99"><i class="fa fa-check"></i>27.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#text-formatting-with-markdown"><i class="fa fa-check"></i>27.3: Text formatting with Markdown</a><ul>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#section-100"><i class="fa fa-check"></i>27.3.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#code-chunks"><i class="fa fa-check"></i>27.4: Code chunks</a><ul>
<li class="chapter" data-level="" data-path="27-r-markdown.html"><a href="27-r-markdown.html#section-101"><i class="fa fa-check"></i>27.4.7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html"><i class="fa fa-check"></i>Ch. 28: Graphics for communication</a><ul>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#label"><i class="fa fa-check"></i>28.2: Label</a><ul>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#section-102"><i class="fa fa-check"></i>28.2.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#annotations"><i class="fa fa-check"></i>28.3: Annotations</a><ul>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#section-103"><i class="fa fa-check"></i>28.3.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#scales"><i class="fa fa-check"></i>28.4: Scales</a><ul>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#section-104"><i class="fa fa-check"></i>28.4.4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#appendix-13"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="28-graphics-for-communication.html"><a href="28-graphics-for-communication.html#section-105"><i class="fa fa-check"></i>28.3.1.5</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Yet another study guide for ‘R for Data Science’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch.-21-iteration" class="section level1">
<h1>Ch. 21: Iteration</h1>

<div class="rmdimportant">
<p><strong>Key questions:</strong></p>
<ul>
<li>21.2.1. #1, 2</li>
<li>21.3.5. #1, 3</li>
<li>21.4.1. #2</li>
<li>21.5.3. #1</li>
<li>21.9.4. #2
</div></li>
</ul>

<div class="rmdtip">
<strong>Functions and notes:</strong>
</div>

<ul>
<li>Common <code>for</code> loop template:</li>
</ul>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb927-1" title="1">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="kw">ncol</span>(df)) <span class="co"># common for loop style  </span></a>
<a class="sourceLine" id="cb927-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">length</span>(df))){</a>
<a class="sourceLine" id="cb927-3" title="3">  output[[i]] &lt;-<span class="st"> </span><span class="kw">fun</span>(df[[i]])</a>
<a class="sourceLine" id="cb927-4" title="4">  }  </a></code></pre></div>
<ul>
<li>Common <code>while</code> loop template:</li>
</ul>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb928-1" title="1">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb928-2" title="2"><span class="cf">while</span> (i <span class="op">&lt;=</span><span class="st"> </span><span class="kw">length</span>(x)){</a>
<a class="sourceLine" id="cb928-3" title="3">  <span class="co"># body</span></a>
<a class="sourceLine" id="cb928-4" title="4">  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb928-5" title="5">}  </a></code></pre></div>
<ul>
<li><code>seq_along(df)</code> does essentially same as <code>seq_len(length(df))</code></li>
<li><code>unlist</code> flatten list of vectors into single vector
<ul>
<li><code>flaten_dbl</code> is stricter alternative</li>
</ul></li>
<li><code>dplyr::bind_rows</code> save output in a list of dfs and then append all at end rather than sequential <code>rbind</code>ing</li>
<li><code>sample(c("T", "H"), 1)</code></li>
<li><code>sapply</code> is wrapper around <code>lapply</code> that automatically simplifies output – problematic in that never know what ouptut will be</li>
<li><code>vapply</code> is safe alternative to <code>sapply</code> e.g. for logical <code>vapply(df, is.numeric, logical(1))</code>, but <code>map_lgl(df, is.numeric)</code> is more simple</li>
<li><code>map()</code> makes a list.
<ul>
<li><code>map_lgl()</code> makes a logical vector.</li>
<li><code>map_int()</code> makes an integer vector.</li>
<li><code>map_dbl()</code> makes a double vector.</li>
<li><code>map_chr()</code> makes a character vector.</li>
</ul></li>
<li>shortcuts for applying functions in <code>map</code>:</li>
</ul>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb929-1" title="1">models &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-2" title="2"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-3" title="3"><span class="st">  </span><span class="kw">map</span>(<span class="cf">function</span>(df) <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> df))</a>
<a class="sourceLine" id="cb929-4" title="4"></a>
<a class="sourceLine" id="cb929-5" title="5">models &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-6" title="6"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-7" title="7"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> .))</a></code></pre></div>
<ul>
<li>extracting by named elements from <code>map</code>:</li>
</ul>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb930-1" title="1">models <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb930-2" title="2"><span class="st">  </span><span class="kw">map</span>(summary) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb930-3" title="3"><span class="st">  </span><span class="kw">map_dbl</span>(<span class="st">&quot;r.squared&quot;</span>)</a></code></pre></div>
<ul>
<li>extracting by positions from <code>map</code></li>
</ul>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb931-1" title="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="kw">list</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="kw">list</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb931-2" title="2">x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb931-3" title="3"><span class="st">  </span><span class="kw">map_dbl</span>(<span class="dv">2</span>)</a></code></pre></div>
<ul>
<li><code>map2</code> let’s you iterate through two components at once</li>
<li><code>pmap</code> allows you to iterate over p components – works well to hold inputs in a dataframe</li>
<li><code>safely</code> takes funciton returns two parts, result and error object
<ul>
<li>similar to <code>try</code> but more consistent</li>
</ul></li>
<li><code>possibly</code> similar to safely, but provide it a default value to return for errors</li>
<li><code>quietly</code> is similar to safely but captures all printed output messages and warnings</li>
<li><code>purrr::transpose</code> allows you to do things like get all 2nd elements in list, e.g. show later</li>
<li><code>invoke_map</code> let’s you iterate over both the functions and the parameters, have an <code>f</code> and a <code>param</code> input, e.g. </li>
</ul>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb932-1" title="1">f &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;runif&quot;</span>, <span class="st">&quot;rnorm&quot;</span>, <span class="st">&quot;rpois&quot;</span>)</a>
<a class="sourceLine" id="cb932-2" title="2">param &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb932-3" title="3">  <span class="kw">list</span>(<span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb932-4" title="4">  <span class="kw">list</span>(<span class="dt">sd =</span> <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb932-5" title="5">  <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb932-6" title="6">)</a>
<a class="sourceLine" id="cb932-7" title="7"></a>
<a class="sourceLine" id="cb932-8" title="8"><span class="kw">invoke_map</span>(f, param, <span class="dt">n =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</a></code></pre></div>
<ul>
<li><code>walk</code> is alternative to <code>map</code> that you call for side effects. Also have <code>walk2</code> and <code>pwalk</code> that are generally more useful
<ul>
<li>all invisibly return `.x (the first argument) so can used in the middle of pipelines</li>
</ul></li>
<li><code>keep</code> and <code>discard</code> keep or discard elements in the input based off if <code>TRUE</code> to predicate</li>
<li><code>some</code> and <code>every</code> determine if the predicte is true for any or for all of our elements</li>
<li><code>detect</code> finds the first element where the predicate is true, <code>detect_index</code> returns its position</li>
<li><code>head_while</code> and <code>tail_while</code> take elements from the start or end of a vector while a predicate is true</li>
<li><code>reduce</code> is good for applying two table rule repeatedly, e.g. joins
<ul>
<li><code>accumulate</code> is similar but keeps all the interim results</li>
</ul></li>
</ul>
<div id="for-loops" class="section level2">
<h2>21.2: For loops</h2>
<div id="section-77" class="section level3">
<h3>21.2.1</h3>
<ol style="list-style-type: decimal">
<li><p>Write for loops to (think about the output, sequence, and body <strong>before</strong> you start writing the loop):</p>
<ol style="list-style-type: decimal">
<li>Compute the mean of every column in <code>mtcars</code>.</li>
</ol>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb933-1" title="1">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="kw">length</span>(mtcars))</a>
<a class="sourceLine" id="cb933-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(mtcars)){</a>
<a class="sourceLine" id="cb933-3" title="3">  output[[i]] &lt;-<span class="st"> </span><span class="kw">mean</span>(mtcars[[i]])</a>
<a class="sourceLine" id="cb933-4" title="4">}</a>
<a class="sourceLine" id="cb933-5" title="5">output</a></code></pre></div>
<pre><code>##  [1]  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250
##  [7]  17.848750   0.437500   0.406250   3.687500   2.812500</code></pre>
<ol style="list-style-type: decimal">
<li>Determine the type of each column in <code>nycflights13::flights</code>.</li>
</ol>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb935-1" title="1">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>, <span class="kw">length</span>(flights))</a>
<a class="sourceLine" id="cb935-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(flights)){</a>
<a class="sourceLine" id="cb935-3" title="3">  output[[i]] &lt;-<span class="st"> </span><span class="kw">typeof</span>(flights[[i]])</a>
<a class="sourceLine" id="cb935-4" title="4">}</a>
<a class="sourceLine" id="cb935-5" title="5">output</a></code></pre></div>
<pre><code>##  [1] &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;  
##  [6] &quot;double&quot;    &quot;integer&quot;   &quot;integer&quot;   &quot;double&quot;    &quot;character&quot;
## [11] &quot;integer&quot;   &quot;character&quot; &quot;character&quot; &quot;character&quot; &quot;double&quot;   
## [16] &quot;double&quot;    &quot;double&quot;    &quot;double&quot;    &quot;double&quot;</code></pre>
<ol style="list-style-type: decimal">
<li>Compute the number of unique values in each column of <code>iris</code>.</li>
</ol>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb937-1" title="1">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;integer&quot;</span>, <span class="kw">length</span>(iris))</a>
<a class="sourceLine" id="cb937-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(iris)){</a>
<a class="sourceLine" id="cb937-3" title="3">  output[[i]] &lt;-<span class="st"> </span><span class="kw">unique</span>(iris[[i]]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>()</a>
<a class="sourceLine" id="cb937-4" title="4">}</a>
<a class="sourceLine" id="cb937-5" title="5">output</a></code></pre></div>
<pre><code>## [1] 35 23 43 22  3</code></pre>
<ol style="list-style-type: decimal">
<li>Generate 10 random normals for each of <span class="math inline">\(\mu = -10\)</span>, <span class="math inline">\(0\)</span>, <span class="math inline">\(10\)</span>, and <span class="math inline">\(100\)</span>.</li>
</ol>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb939-1" title="1">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb939-2" title="2">input_means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb939-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(output)){</a>
<a class="sourceLine" id="cb939-4" title="4">  output[[i]] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> input_means[[i]])</a>
<a class="sourceLine" id="cb939-5" title="5">}</a>
<a class="sourceLine" id="cb939-6" title="6">output</a></code></pre></div>
<pre><code>## [[1]]
##  [1] -11.371326 -10.118467 -10.582961 -10.324829  -7.604983  -9.300232
##  [7]  -9.840124  -9.719733  -9.784274 -10.338814
## 
## [[2]]
##  [1] -1.04951842 -0.68385670  0.17893523  0.07338463 -1.18028235
##  [6] -1.00777188  0.91491408 -0.14041984 -0.25074297 -0.50055019
## 
## [[3]]
##  [1] 11.013913  9.790495 10.631115 10.325991 10.608040  9.463515 11.265961
##  [8] 10.630382 10.436201  8.907654
## 
## [[4]]
##  [1]  99.37012 100.31396  99.06230  98.00350 100.31506  99.67347 101.02248
##  [8]  98.32484  98.62669 100.28487</code></pre></li>
<li><p>Eliminate the for loop in each of the following examples by taking advantage of an existing function that works with vectors:</p>
<p><em>example:</em></p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb941-1" title="1">out &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb941-2" title="2"><span class="cf">for</span> (x <span class="cf">in</span> letters) {</a>
<a class="sourceLine" id="cb941-3" title="3">  out &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_c</span>(out, x)</a>
<a class="sourceLine" id="cb941-4" title="4">}</a>
<a class="sourceLine" id="cb941-5" title="5">out</a></code></pre></div>
<ul>
<li>collabse letters into length-one character vector with all characters concatenated</li>
</ul>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb942-1" title="1"><span class="kw">str_c</span>(letters, <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;abcdefghijklmnopqrstuvwxyz&quot;</code></pre>
<p><em>example:</em></p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb944-1" title="1">x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb944-2" title="2">sd &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb944-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {</a>
<a class="sourceLine" id="cb944-4" title="4">  sd &lt;-<span class="st"> </span>sd <span class="op">+</span><span class="st"> </span>(x[i] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb944-5" title="5">}</a>
<a class="sourceLine" id="cb944-6" title="6">sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sd <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb944-7" title="7">sd</a></code></pre></div>
<pre><code>## [1] 29.01149</code></pre>
<ul>
<li>calculate standard deviaiton of x</li>
</ul>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb946-1" title="1"><span class="kw">sd</span>(x)</a></code></pre></div>
<pre><code>## [1] 29.01149</code></pre>
<p><em>example:</em></p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb948-1" title="1">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb948-2" title="2">out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb948-3" title="3">out[<span class="dv">1</span>] &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb948-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(x)) {</a>
<a class="sourceLine" id="cb948-5" title="5">  out[i] &lt;-<span class="st"> </span>out[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>x[i]</a>
<a class="sourceLine" id="cb948-6" title="6">}</a>
<a class="sourceLine" id="cb948-7" title="7">out</a></code></pre></div>
<pre><code>##   [1]  0.1543797  0.5168570  1.4323513  1.4861995  1.7440626  2.3503876
##   [7]  2.7033856  3.4933038  3.8878801  4.8166162  4.8404351  5.0134399
##  [13]  5.8128633  5.9002886  6.4672338  7.3249551  7.4813311  7.9067374
##  [19]  7.9143362  8.6500421  9.4114592  9.8109883 10.6637337 11.5345437
##  [25] 11.8881403 12.8609933 13.0060893 13.1121490 13.2820768 13.7832678
##  [31] 14.0103818 14.8921300 15.8878166 16.3724888 17.2897726 17.6764167
##  [37] 18.3759822 18.5914902 18.7581008 19.3126850 20.0314901 20.9729033
##  [43] 21.5123325 22.1361972 22.9338153 23.9220106 23.9905409 24.1247463
##  [49] 24.3690186 24.6778073 25.1676470 25.6649358 26.0152919 26.3936317
##  [55] 26.6769802 26.7589431 27.4933689 28.3744835 28.8274173 29.5040112
##  [61] 30.4625068 31.1908181 31.5785996 32.0691594 32.4015008 33.1859971
##  [67] 34.0973779 34.4118215 34.6828655 34.9383821 35.5988994 35.9820211
##  [73] 36.7825814 37.5402040 37.9568733 38.5686788 38.6336509 39.0451422
##  [79] 39.1208101 39.8826954 40.4989736 41.2877620 41.4204198 41.8790701
##  [85] 42.8085235 43.2102977 43.4620636 43.9427926 44.7306195 45.4886119
##  [91] 46.0891834 46.4679661 47.0817039 47.6331389 48.1357901 48.3671822
##  [97] 48.8290107 49.8198761 50.6520274 50.6527903</code></pre>
<ul>
<li>calculate cumulative sum</li>
</ul>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb950-1" title="1"><span class="kw">cumsum</span>(x)</a></code></pre></div>
<pre><code>##   [1]  0.1543797  0.5168570  1.4323513  1.4861995  1.7440626  2.3503876
##   [7]  2.7033856  3.4933038  3.8878801  4.8166162  4.8404351  5.0134399
##  [13]  5.8128633  5.9002886  6.4672338  7.3249551  7.4813311  7.9067374
##  [19]  7.9143362  8.6500421  9.4114592  9.8109883 10.6637337 11.5345437
##  [25] 11.8881403 12.8609933 13.0060893 13.1121490 13.2820768 13.7832678
##  [31] 14.0103818 14.8921300 15.8878166 16.3724888 17.2897726 17.6764167
##  [37] 18.3759822 18.5914902 18.7581008 19.3126850 20.0314901 20.9729033
##  [43] 21.5123325 22.1361972 22.9338153 23.9220106 23.9905409 24.1247463
##  [49] 24.3690186 24.6778073 25.1676470 25.6649358 26.0152919 26.3936317
##  [55] 26.6769802 26.7589431 27.4933689 28.3744835 28.8274173 29.5040112
##  [61] 30.4625068 31.1908181 31.5785996 32.0691594 32.4015008 33.1859971
##  [67] 34.0973779 34.4118215 34.6828655 34.9383821 35.5988994 35.9820211
##  [73] 36.7825814 37.5402040 37.9568733 38.5686788 38.6336509 39.0451422
##  [79] 39.1208101 39.8826954 40.4989736 41.2877620 41.4204198 41.8790701
##  [85] 42.8085235 43.2102977 43.4620636 43.9427926 44.7306195 45.4886119
##  [91] 46.0891834 46.4679661 47.0817039 47.6331389 48.1357901 48.3671822
##  [97] 48.8290107 49.8198761 50.6520274 50.6527903</code></pre></li>
<li><p>Combine your function writing and for loop skills:</p>
<ol style="list-style-type: decimal">
<li>Write a for loop that <code>prints()</code> the lyrics to the children’s song “Alice the camel”.</li>
</ol>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb952-1" title="1">num_humps &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;five&quot;</span>, <span class="st">&quot;four&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;no&quot;</span>)</a>
<a class="sourceLine" id="cb952-2" title="2"></a>
<a class="sourceLine" id="cb952-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(num_humps)){</a>
<a class="sourceLine" id="cb952-4" title="4"></a>
<a class="sourceLine" id="cb952-5" title="5">  <span class="kw">paste0</span>(<span class="st">&quot;Alice the camel has &quot;</span>, num_humps[[i]], <span class="st">&quot; humps.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb952-6" title="6"><span class="st">    </span><span class="kw">rep</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb952-7" title="7"><span class="st">    </span><span class="kw">writeLines</span>()</a>
<a class="sourceLine" id="cb952-8" title="8"></a>
<a class="sourceLine" id="cb952-9" title="9">  <span class="kw">writeLines</span>(<span class="st">&quot;So go, Alice, go.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb952-10" title="10">}</a></code></pre></div>
<pre><code>## Alice the camel has five humps.
## Alice the camel has five humps.
## Alice the camel has five humps.
## So go, Alice, go.
## 
## Alice the camel has four humps.
## Alice the camel has four humps.
## Alice the camel has four humps.
## So go, Alice, go.
## 
## Alice the camel has three humps.
## Alice the camel has three humps.
## Alice the camel has three humps.
## So go, Alice, go.
## 
## Alice the camel has two humps.
## Alice the camel has two humps.
## Alice the camel has two humps.
## So go, Alice, go.
## 
## Alice the camel has one humps.
## Alice the camel has one humps.
## Alice the camel has one humps.
## So go, Alice, go.
## 
## Alice the camel has no humps.
## Alice the camel has no humps.
## Alice the camel has no humps.
## So go, Alice, go.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Convert the nursery rhyme “ten in the bed” to a function. Generalise it to any number of people in any sleeping structure.</li>
</ol>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb954-1" title="1">nursery_bed &lt;-<span class="st"> </span><span class="cf">function</span>(num, y) {</a>
<a class="sourceLine" id="cb954-2" title="2">  output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>, num)</a>
<a class="sourceLine" id="cb954-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(output)) {</a>
<a class="sourceLine" id="cb954-4" title="4">    output[[i]] &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(</a>
<a class="sourceLine" id="cb954-5" title="5">    <span class="st">&#39;There were x in the _y</span><span class="ch">\n</span><span class="st"> And the little one said, </span><span class="ch">\n</span><span class="st">&quot;Roll over! Roll over!&quot;</span><span class="ch">\n</span><span class="st"> So they all rolled over and</span><span class="ch">\n</span><span class="st"> one fell out.&#39;</span>, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span> =<span class="st"> </span>(<span class="kw">length</span>(output) <span class="op">-</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="st">&quot;_y&quot;</span> =<span class="st"> </span>y))</a>
<a class="sourceLine" id="cb954-6" title="6">  } </a>
<a class="sourceLine" id="cb954-7" title="7">  <span class="kw">str_c</span>(output, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb954-8" title="8"><span class="st">    </span><span class="kw">writeLines</span>()</a>
<a class="sourceLine" id="cb954-9" title="9">}</a>
<a class="sourceLine" id="cb954-10" title="10"></a>
<a class="sourceLine" id="cb954-11" title="11"><span class="kw">nursery_bed</span>(<span class="dv">3</span>, <span class="st">&quot;asteroid&quot;</span>)</a></code></pre></div>
<pre><code>## There were 3 in the asteroid
##  And the little one said, 
## &quot;Roll over! Roll over!&quot;
##  So they all rolled over and
##  one fell out.
## 
## There were 2 in the asteroid
##  And the little one said, 
## &quot;Roll over! Roll over!&quot;
##  So they all rolled over and
##  one fell out.
## 
## There were 1 in the asteroid
##  And the little one said, 
## &quot;Roll over! Roll over!&quot;
##  So they all rolled over and
##  one fell out.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Convert the song “99 bottles of beer on the wall” to a function. Generalise to any number of any vessel containing any liquid on any surface.</li>
</ol>
<ul>
<li>This is a little bit of a lazy version…</li>
</ul>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb956-1" title="1">beer_rhyme &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, z){</a>
<a class="sourceLine" id="cb956-2" title="2">  output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>, x)</a>
<a class="sourceLine" id="cb956-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(output)){</a>
<a class="sourceLine" id="cb956-4" title="4">    output[i] &lt;-</a>
<a class="sourceLine" id="cb956-5" title="5"><span class="st">      </span><span class="kw">str_replace_all</span>(<span class="st">&quot;x bottles of y on the z.</span><span class="ch">\n</span><span class="st"> One fell off...&quot;</span>, <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb956-6" title="6">      <span class="st">&quot;x&quot;</span> =<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb956-7" title="7">      <span class="st">&quot;y&quot;</span> =<span class="st"> </span>y,</a>
<a class="sourceLine" id="cb956-8" title="8">      <span class="st">&quot;z&quot;</span> =<span class="st"> </span>z</a>
<a class="sourceLine" id="cb956-9" title="9">      ))</a>
<a class="sourceLine" id="cb956-10" title="10">  }</a>
<a class="sourceLine" id="cb956-11" title="11">  output &lt;-<span class="st"> </span>(<span class="kw">str_c</span>(output, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb956-12" title="12"><span class="st">               </span><span class="kw">str_c</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">No more bottles...&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb956-13" title="13">  <span class="kw">writeLines</span>(output)</a>
<a class="sourceLine" id="cb956-14" title="14">}</a>
<a class="sourceLine" id="cb956-15" title="15"></a>
<a class="sourceLine" id="cb956-16" title="16"><span class="kw">beer_rhyme</span>(<span class="dv">4</span>, <span class="st">&quot;soda&quot;</span>, <span class="st">&quot;toilet&quot;</span>)</a></code></pre></div>
<pre><code>## 4 bottles of soda on the toilet.
##  One fell off...
## 3 bottles of soda on the toilet.
##  One fell off...
## 2 bottles of soda on the toilet.
##  One fell off...
## 1 bottles of soda on the toilet.
##  One fell off...
## No more bottles...</code></pre></li>
<li><p>It’s common to see for loops that don’t preallocate the output and instead increase the length of a vector at each step. How does this affect performance? Design and execute an experiment.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb958-1" title="1">preallocate &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb958-2" title="2">x &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb958-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)){</a>
<a class="sourceLine" id="cb958-4" title="4">    x[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb958-5" title="5">  }</a>
<a class="sourceLine" id="cb958-6" title="6">}</a>
<a class="sourceLine" id="cb958-7" title="7"></a>
<a class="sourceLine" id="cb958-8" title="8">growing &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb958-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb958-10" title="10">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb958-11" title="11">      x[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb958-12" title="12">  }</a>
<a class="sourceLine" id="cb958-13" title="13">}</a>
<a class="sourceLine" id="cb958-14" title="14"></a>
<a class="sourceLine" id="cb958-15" title="15">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb958-16" title="16">  <span class="dt">space =</span> <span class="kw">preallocate</span>(),</a>
<a class="sourceLine" id="cb958-17" title="17">  <span class="dt">no_space =</span> <span class="kw">growing</span>(),</a>
<a class="sourceLine" id="cb958-18" title="18">  <span class="dt">times =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb958-19" title="19">)  </a></code></pre></div>
<pre><code>## Unit: microseconds
##      expr   min    lq    mean median     uq    max neval cld
##     space 178.0 183.6 523.665 308.05 342.65 4991.2    20   a
##  no_space 213.6 222.2 531.440 344.50 429.05 4081.9    20   a</code></pre>
<ul>
<li>see roughly 35% better performance when creating ahead of time</li>
<li>note: if you can do these operations with vectorized approach though – they’re often much faster</li>
</ul>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb960-1" title="1">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb960-2" title="2">  <span class="dt">space =</span> <span class="kw">preallocate</span>(),</a>
<a class="sourceLine" id="cb960-3" title="3">  <span class="dt">no_space =</span> <span class="kw">growing</span>(),</a>
<a class="sourceLine" id="cb960-4" title="4">  <span class="dt">vector =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb960-5" title="5">  <span class="dt">times =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb960-6" title="6">)</a></code></pre></div>
<pre><code>## Unit: microseconds
##      expr   min     lq    mean median     uq   max neval cld
##     space 155.8 161.45 177.075 163.50 166.20 349.6    20  b 
##  no_space 185.8 193.65 202.390 199.55 205.25 234.5    20   c
##    vector   8.8   9.45   9.795   9.70  10.10  11.0    20 a</code></pre>
<ul>
<li>vectorized was &gt; 10x faster</li>
</ul></li>
</ol>
</div>
</div>
<div id="for-loop-variations" class="section level2">
<h2>21.3 For loop variations</h2>
<div id="section-78" class="section level3">
<h3>21.3.5</h3>
<ol style="list-style-type: decimal">
<li><p>Imagine you have a directory full of CSV files that you want to read in. You have their paths in a vector, <code>files &lt;- dir("data/", pattern = "\\.csv$", full.names = TRUE)</code>, and now want to read each one with <code>read_csv()</code>. Write the for loop that will load them into a single data frame.</p>
<ul>
<li>To start this problem, I first created a file directory, and then wrote in 26 csvs each with the most popular name from each year since 1880 for a particular letter<a href="#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a>.</li>
<li>Next I read these into a single dataframe with a for loop</li>
</ul></li>
<li><p><em>What happens if you use <code>for (nm in names(x))</code> and <code>x</code> has no names?</em></p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb967-1" title="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">11</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb967-2" title="2"><span class="cf">for</span> (nm <span class="cf">in</span> <span class="kw">names</span>(x)) {</a>
<a class="sourceLine" id="cb967-3" title="3">  <span class="kw">print</span>(x[[nm]])</a>
<a class="sourceLine" id="cb967-4" title="4">}</a></code></pre></div>
<ul>
<li>each iteration produces an error, so nothing is written</li>
</ul>
<p><em>What if only some of the elements are named?</em></p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb968-1" title="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">11</span><span class="op">:</span><span class="dv">18</span>, <span class="dt">c =</span> <span class="dv">19</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb968-2" title="2"><span class="cf">for</span> (nm <span class="cf">in</span> <span class="kw">names</span>(x)) {</a>
<a class="sourceLine" id="cb968-3" title="3">  <span class="kw">print</span>(x[[nm]])</a>
<a class="sourceLine" id="cb968-4" title="4">}</a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
## NULL
## [1] 19 20 21 22 23 24 25</code></pre>
<ul>
<li>you have output for those with names and NULL for those without</li>
</ul>
<p><em>What if the names are not unique?</em></p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb970-1" title="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">a =</span> <span class="dv">11</span><span class="op">:</span><span class="dv">18</span>, <span class="dt">c =</span> <span class="dv">19</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb970-2" title="2"><span class="cf">for</span> (nm <span class="cf">in</span> <span class="kw">names</span>(x)) {</a>
<a class="sourceLine" id="cb970-3" title="3">  <span class="kw">print</span>(x[[nm]])</a>
<a class="sourceLine" id="cb970-4" title="4">}</a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
##  [1]  1  2  3  4  5  6  7  8  9 10
## [1] 19 20 21 22 23 24 25</code></pre>
<ul>
<li>it prints the first position with the name</li>
</ul></li>
<li><p>Write a function that prints the mean of each numeric column in a data frame, along with its name. For example, <code>show_mean(iris)</code> would print:</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb972-1" title="1"><span class="kw">show_mean</span>(iris)</a>
<a class="sourceLine" id="cb972-2" title="2"><span class="co">#&gt; Sepal.Length: 5.84</span></a>
<a class="sourceLine" id="cb972-3" title="3"><span class="co">#&gt; Sepal.Width:  3.06</span></a>
<a class="sourceLine" id="cb972-4" title="4"><span class="co">#&gt; Petal.Length: 3.76</span></a>
<a class="sourceLine" id="cb972-5" title="5"><span class="co">#&gt; Petal.Width:  1.20</span></a></code></pre></div>
<p>(Extra challenge: what function did I use to make sure that the numbers lined up nicely, even though the variable names had different lengths?)</p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb973-1" title="1">show_mean &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb973-2" title="2">  <span class="co"># select just cols that are numeric</span></a>
<a class="sourceLine" id="cb973-3" title="3">  out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;logical&quot;</span>, <span class="kw">length</span>(df))</a>
<a class="sourceLine" id="cb973-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(df)) {</a>
<a class="sourceLine" id="cb973-5" title="5">    out[[i]] &lt;-<span class="st"> </span><span class="kw">is.numeric</span>(df[[i]])</a>
<a class="sourceLine" id="cb973-6" title="6">  } </a>
<a class="sourceLine" id="cb973-7" title="7">  df_select &lt;-<span class="st"> </span>df[out]</a>
<a class="sourceLine" id="cb973-8" title="8">  <span class="co"># keep/discard funs would have made this easy</span></a>
<a class="sourceLine" id="cb973-9" title="9"></a>
<a class="sourceLine" id="cb973-10" title="10">  <span class="co"># make list of values w/ mean</span></a>
<a class="sourceLine" id="cb973-11" title="11">  means &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(df_select))</a>
<a class="sourceLine" id="cb973-12" title="12">  <span class="kw">names</span>(means) &lt;-<span class="st"> </span><span class="kw">names</span>(df_select)</a>
<a class="sourceLine" id="cb973-13" title="13">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(df_select)){</a>
<a class="sourceLine" id="cb973-14" title="14">    means[[i]] &lt;-<span class="st"> </span><span class="kw">mean</span>(df_select[[i]], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb973-15" title="15"><span class="st">      </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb973-16" title="16">  }</a>
<a class="sourceLine" id="cb973-17" title="17"></a>
<a class="sourceLine" id="cb973-18" title="18">  <span class="co"># print out, use method to identify max chars for vars printed</span></a>
<a class="sourceLine" id="cb973-19" title="19">  means_names &lt;-<span class="st"> </span><span class="kw">names</span>(means)</a>
<a class="sourceLine" id="cb973-20" title="20">  chars_max &lt;-<span class="st"> </span>(<span class="kw">str_count</span>(means_names) <span class="op">+</span><span class="st"> </span><span class="kw">str_count</span>(<span class="kw">as.character</span>(means))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb973-21" title="21"><span class="st">    </span><span class="kw">max</span>()</a>
<a class="sourceLine" id="cb973-22" title="22"></a>
<a class="sourceLine" id="cb973-23" title="23">  chars_pad &lt;-<span class="st"> </span>chars_max <span class="op">-</span><span class="st"> </span>(<span class="kw">str_count</span>(means_names) <span class="op">+</span><span class="st"> </span><span class="kw">str_count</span>(<span class="kw">as.character</span>(means)))</a>
<a class="sourceLine" id="cb973-24" title="24"></a>
<a class="sourceLine" id="cb973-25" title="25">  <span class="kw">names</span>(chars_pad) &lt;-<span class="st"> </span>means_names</a>
<a class="sourceLine" id="cb973-26" title="26"></a>
<a class="sourceLine" id="cb973-27" title="27"><span class="kw">str_c</span>(means_names, <span class="st">&quot;: &quot;</span>, <span class="kw">str_dup</span>(<span class="st">&quot; &quot;</span>, chars_pad), means) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb973-28" title="28"><span class="st">  </span><span class="kw">writeLines</span>()</a>
<a class="sourceLine" id="cb973-29" title="29">}</a>
<a class="sourceLine" id="cb973-30" title="30"></a>
<a class="sourceLine" id="cb973-31" title="31"><span class="kw">show_mean</span>(flights)</a></code></pre></div>
<pre><code>## year:              2013
## month:             6.55
## day:              15.71
## dep_time:       1349.11
## sched_dep_time: 1344.25
## dep_delay:        12.64
## arr_time:       1502.05
## sched_arr_time: 1536.38
## arr_delay:          6.9
## flight:         1971.92
## air_time:        150.69
## distance:       1039.91
## hour:             13.18
## minute:           26.23</code></pre></li>
<li><p>What does this code do? How does it work?</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb975-1" title="1">trans &lt;-<span class="st"> </span><span class="kw">list</span>( </a>
<a class="sourceLine" id="cb975-2" title="2">  <span class="dt">disp =</span> <span class="cf">function</span>(x) x <span class="op">*</span><span class="st"> </span><span class="fl">0.0163871</span>,</a>
<a class="sourceLine" id="cb975-3" title="3">  <span class="dt">am =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb975-4" title="4">    <span class="kw">factor</span>(x, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;auto&quot;</span>, <span class="st">&quot;manual&quot;</span>))</a>
<a class="sourceLine" id="cb975-5" title="5">  }</a>
<a class="sourceLine" id="cb975-6" title="6">)</a>
<a class="sourceLine" id="cb975-7" title="7"><span class="cf">for</span> (var <span class="cf">in</span> <span class="kw">names</span>(trans)) {</a>
<a class="sourceLine" id="cb975-8" title="8">  mtcars[[var]] &lt;-<span class="st"> </span>trans[[var]](mtcars[[var]])</a>
<a class="sourceLine" id="cb975-9" title="9">}</a>
<a class="sourceLine" id="cb975-10" title="10">mtcars</a></code></pre></div>
<ul>
<li>first part builds list of functions, 2nd applies those to a dataset</li>
<li>are storing the data transformations as a function and then applying this to a dataframe<a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a></li>
</ul></li>
</ol>
</div>
</div>
<div id="for-loops-vs.-functionals" class="section level2">
<h2>21.4: For loops vs. functionals</h2>
<div id="section-79" class="section level3">
<h3>21.4.1</h3>
<ol style="list-style-type: decimal">
<li><p>Read the documentation for <code>apply()</code>. In the 2d case, what two for loops does it generalise?</p>
<ul>
<li>It allows you to input either 1 or 2 for the <code>MARGIN</code> argument, which corresponds with looping over either the rows or the columns.</li>
</ul></li>
<li><p>Adapt <code>col_summary()</code> so that it only applies to numeric columns You might want to start with an <code>is_numeric()</code> function that returns a logical vector that has a TRUE corresponding to each numeric column.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb976-1" title="1">col_summary_gen &lt;-<span class="st"> </span><span class="cf">function</span>(df, fun, ...) {</a>
<a class="sourceLine" id="cb976-2" title="2">  <span class="co">#find cols that are numeric</span></a>
<a class="sourceLine" id="cb976-3" title="3">  out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;logical&quot;</span>, <span class="kw">length</span>(df))</a>
<a class="sourceLine" id="cb976-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(df)) {</a>
<a class="sourceLine" id="cb976-5" title="5">    out[[i]] &lt;-<span class="st"> </span><span class="kw">is.numeric</span>(df[[i]])</a>
<a class="sourceLine" id="cb976-6" title="6">  }</a>
<a class="sourceLine" id="cb976-7" title="7">  <span class="co">#make list of values w/ mean</span></a>
<a class="sourceLine" id="cb976-8" title="8">  df_select &lt;-<span class="st"> </span>df[out]</a>
<a class="sourceLine" id="cb976-9" title="9">  output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(df_select))</a>
<a class="sourceLine" id="cb976-10" title="10">  <span class="kw">names</span>(output) &lt;-<span class="st"> </span><span class="kw">names</span>(df_select)</a>
<a class="sourceLine" id="cb976-11" title="11">  <span class="cf">for</span> (nm <span class="cf">in</span> <span class="kw">names</span>(output)) {</a>
<a class="sourceLine" id="cb976-12" title="12">    output[[nm]] &lt;-<span class="st"> </span><span class="kw">fun</span>(df_select[[nm]], ...) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb976-13" title="13"><span class="st">      </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb976-14" title="14">  }</a>
<a class="sourceLine" id="cb976-15" title="15"></a>
<a class="sourceLine" id="cb976-16" title="16">  <span class="kw">as_tibble</span>(output)</a>
<a class="sourceLine" id="cb976-17" title="17">}</a>
<a class="sourceLine" id="cb976-18" title="18"></a>
<a class="sourceLine" id="cb976-19" title="19"><span class="kw">col_summary_gen</span>(flights, <span class="dt">fun =</span> median, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb976-20" title="20"><span class="st">  </span><span class="kw">gather</span>() <span class="co"># trick to gather all easily</span></a></code></pre></div>
<pre><code>## # A tibble: 14 x 2
##    key            value
##    &lt;chr&gt;          &lt;dbl&gt;
##  1 year            2013
##  2 month              7
##  3 day               16
##  4 dep_time        1401
##  5 sched_dep_time  1359
##  6 dep_delay         -2
##  7 arr_time        1535
##  8 sched_arr_time  1556
##  9 arr_delay         -5
## 10 flight          1496
## 11 air_time         129
## 12 distance         872
## 13 hour              13
## 14 minute            29</code></pre>
<ul>
<li>the <code>...</code> makes this so you can add arguments to the functions.</li>
</ul></li>
</ol>
</div>
</div>
<div id="the-map-functions" class="section level2">
<h2>21.5: The map functions</h2>
<div id="section-80" class="section level3">
<h3>21.5.3</h3>
<ol style="list-style-type: decimal">
<li><p>Write code that uses one of the map functions to:</p>
<p><em>Compute the mean of every column in <code>mtcars</code>.</em></p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb978-1" title="1">purrr<span class="op">::</span><span class="kw">map_dbl</span>(mtcars, mean)</a></code></pre></div>
<pre><code>##        mpg        cyl       disp         hp       drat         wt 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250 
##       qsec         vs         am       gear       carb 
##  17.848750   0.437500   0.406250   3.687500   2.812500</code></pre>
<p><em>Determine the type of each column in <code>nycflights13::flights</code>.</em></p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb980-1" title="1">purrr<span class="op">::</span><span class="kw">map_chr</span>(flights, typeof)</a></code></pre></div>
<pre><code>##           year          month            day       dep_time sched_dep_time 
##      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot; 
##      dep_delay       arr_time sched_arr_time      arr_delay        carrier 
##       &quot;double&quot;      &quot;integer&quot;      &quot;integer&quot;       &quot;double&quot;    &quot;character&quot; 
##         flight        tailnum         origin           dest       air_time 
##      &quot;integer&quot;    &quot;character&quot;    &quot;character&quot;    &quot;character&quot;       &quot;double&quot; 
##       distance           hour         minute      time_hour 
##       &quot;double&quot;       &quot;double&quot;       &quot;double&quot;       &quot;double&quot;</code></pre>
<p><em>Compute the number of unique values in each column of <code>iris</code>.</em></p>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb982-1" title="1">purrr<span class="op">::</span><span class="kw">map</span>(iris, unique) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb982-2" title="2"><span class="st">  </span><span class="kw">map_dbl</span>(length)</a></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##           35           23           43           22            3</code></pre>
<p><em>Generate 10 random normals for each of <span class="math inline">\(\mu = -10\)</span>, <span class="math inline">\(0\)</span>, <span class="math inline">\(10\)</span>, and <span class="math inline">\(100\)</span>.</em></p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb984-1" title="1">purrr<span class="op">::</span><span class="kw">map</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>), rnorm, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [[1]]
##  [1] -11.668016 -10.174630  -9.873417  -9.935144  -9.549267  -9.989001
##  [7]  -9.991157  -9.490583  -9.020713 -11.215907
## 
## [[2]]
##  [1] -1.3330518  1.7970408 -0.7859694 -1.5184894  0.4544287  0.2134496
##  [7] -1.0761067  0.1600194 -0.1258518 -0.6974829
## 
## [[3]]
##  [1] 10.334081  9.523160  9.730305 10.855434 10.899334 11.522520  9.532049
##  [8]  9.778320 10.276128  9.939547
## 
## [[4]]
##  [1]  98.63699 100.57597 100.23664  99.65274 100.66985  99.86635  99.79877
##  [8]  98.84634 101.00019  99.09162</code></pre>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb986-1" title="1"><span class="co"># purrr::map_dbl(flights, ~mean(is.na(.x)))</span></a></code></pre></div></li>
<li><p>How can you create a single vector that for each column in a data frame indicates whether or not it’s a factor?</p>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb987-1" title="1">purrr<span class="op">::</span><span class="kw">map_lgl</span>(iris, is.factor)</a></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##        FALSE        FALSE        FALSE        FALSE         TRUE</code></pre></li>
<li><p>What happens when you use the map functions on vectors that aren’t lists? What does <code>map(1:5, runif)</code> do? Why?</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb989-1" title="1">purrr<span class="op">::</span><span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, rnorm)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.26078
## 
## [[2]]
## [1] 0.39670324 0.03106982
## 
## [[3]]
## [1]  1.0644632 -0.1632358 -1.0353975
## 
## [[4]]
## [1] -0.3556528 -0.5027896  2.0659595 -0.1360896
## 
## [[5]]
## [1]  0.50936851  0.16219258 -1.53746908 -0.04141543 -0.79950355</code></pre>
<ul>
<li>It runs on each item in the vector.</li>
<li><code>map()</code> runs on each element item within the input, i.e .x[[1]], .x[[2]], .x[[n]]. The elements of a numeric vector are scalars (or technically length 1 numeric vectors)</li>
<li>In this case then it is passing the values 1, 2, 3, 4, 5 into the first argument of <code>rnorm</code> for each run, hence pattern above.</li>
</ul></li>
<li><p>What does <code>map(-2:2, rnorm, n = 5)</code> do? Why?</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb991-1" title="1"><span class="kw">map</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>, rnorm, <span class="dt">n =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] -1.829446 -3.357986 -3.582975 -2.039341 -2.087265
## 
## [[2]]
## [1] -0.6831658 -0.8729133 -0.3192894 -1.3425364  0.2383131
## 
## [[3]]
## [1]  0.43215278 -0.07629132 -0.14400722  1.85870258  0.13472292
## 
## [[4]]
## [1] -0.22256104  2.00645188 -0.06027834  1.44273092  0.69404413
## 
## [[5]]
## [1] 1.642268 2.233247 2.021023 1.988244 2.798515</code></pre>
<ul>
<li>It makes 5 vectors each of length 5 with the values centered at the means of -2,-1, 0, 1, 2 respectively.</li>
<li>The reason is that the default filling of the first argument is already named by the defined input of ‘n = 5’, therefore, the inputs are instead going to the 2nd argument, and hence become the mean of the different rnorm calls.</li>
</ul></li>
<li><p>Rewrite <code>map(x, function(df) lm(mpg ~ wt, data = df))</code> to eliminate the anonymous function.</p>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb993-1" title="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb993-2" title="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>( <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> .))</a></code></pre></div></li>
</ol>
</div>
</div>
<div id="other-patterns-of-for-loops" class="section level2">
<h2>21.9 Other patterns of for loops</h2>
<div id="section-81" class="section level3">
<h3>21.9.3</h3>
<ol style="list-style-type: decimal">
<li><p>Implement your own version of <code>every()</code> using a for loop. Compare it with <code>purrr::every()</code>. What does purrr’s version do that your version doesn’t?</p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb994-1" title="1">every_loop &lt;-<span class="st"> </span><span class="cf">function</span>(x, fun, ...) {</a>
<a class="sourceLine" id="cb994-2" title="2">  output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb994-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {</a>
<a class="sourceLine" id="cb994-4" title="4">  output[[i]] &lt;-<span class="st"> </span><span class="kw">fun</span>(x[[i]])</a>
<a class="sourceLine" id="cb994-5" title="5">  }</a>
<a class="sourceLine" id="cb994-6" title="6">  total &lt;-<span class="st"> </span><span class="kw">flatten_lgl</span>(output)</a>
<a class="sourceLine" id="cb994-7" title="7">  <span class="kw">sum</span>(total) <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb994-8" title="8">}</a>
<a class="sourceLine" id="cb994-9" title="9"></a>
<a class="sourceLine" id="cb994-10" title="10">x &lt;-<span class="st"> </span><span class="kw">list</span>(flights, mtcars, iris)</a>
<a class="sourceLine" id="cb994-11" title="11"><span class="kw">every_loop</span>(x, is.data.frame)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb996-1" title="1"><span class="kw">every</span>(x, is.data.frame)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre></li>
<li><p>Create an enhanced <code>col_sum()</code> that applies a summary function to every numeric column in a data frame.</p>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb998-1" title="1">col_summary_enh &lt;-<span class="st"> </span><span class="cf">function</span>(x,fun){</a>
<a class="sourceLine" id="cb998-2" title="2">  x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb998-3" title="3"><span class="st">    </span><span class="kw">keep</span>(is.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb998-4" title="4"><span class="st">    </span>purrr<span class="op">::</span><span class="kw">map_dbl</span>(fun)</a>
<a class="sourceLine" id="cb998-5" title="5">}</a>
<a class="sourceLine" id="cb998-6" title="6"><span class="kw">col_summary_enh</span>(mtcars, median)</a></code></pre></div>
<pre><code>##     mpg     cyl    disp      hp    drat      wt    qsec      vs      am 
##  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000 
##    gear    carb 
##   4.000   2.000</code></pre></li>
<li><p>A possible base R equivalent of <code>col_sum()</code> is:</p>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1000-1" title="1">col_sum3 &lt;-<span class="st"> </span><span class="cf">function</span>(df, f) {</a>
<a class="sourceLine" id="cb1000-2" title="2">  is_num &lt;-<span class="st"> </span><span class="kw">sapply</span>(df, is.numeric)</a>
<a class="sourceLine" id="cb1000-3" title="3">  df_num &lt;-<span class="st"> </span>df[, is_num]</a>
<a class="sourceLine" id="cb1000-4" title="4"></a>
<a class="sourceLine" id="cb1000-5" title="5">  <span class="kw">sapply</span>(df_num, f)</a>
<a class="sourceLine" id="cb1000-6" title="6">}</a></code></pre></div>
<p>But it has a number of bugs as illustrated with the following inputs:</p>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1001-1" title="1">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb1001-2" title="2">  <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb1001-3" title="3">  <span class="dt">y =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1001-4" title="4">  <span class="dt">z =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb1001-5" title="5">)</a>
<a class="sourceLine" id="cb1001-6" title="6"><span class="co"># OK</span></a>
<a class="sourceLine" id="cb1001-7" title="7"><span class="kw">col_sum3</span>(df, mean) </a>
<a class="sourceLine" id="cb1001-8" title="8"><span class="co"># Has problems: don&#39;t always return numeric vector</span></a>
<a class="sourceLine" id="cb1001-9" title="9"><span class="kw">col_sum3</span>(df[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], mean) </a>
<a class="sourceLine" id="cb1001-10" title="10"><span class="kw">col_sum3</span>(df[<span class="dv">1</span>], mean) </a>
<a class="sourceLine" id="cb1001-11" title="11"><span class="kw">col_sum3</span>(df[<span class="dv">0</span>], mean)</a></code></pre></div>
<p>What causes the bugs?</p>
<ul>
<li>The vector output is not always consistent in it’s output type. Also, returns error when inputting an empty list due to indexing issue.</li>
</ul></li>
</ol>
</div>
</div>
<div id="appendix-9" class="section level2">
<h2>Appendix</h2>
<div id="section-82" class="section level3">
<h3>21.3.5.1</h3>
<div id="using-map" class="section level4">
<h4>Using map</h4>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1002-1" title="1">    outputted_csv &lt;-<span class="st"> </span>files_example <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1002-2" title="2"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">csv_data =</span> <span class="kw">map</span>(file_paths, read_csv))</a>
<a class="sourceLine" id="cb1002-3" title="3">    </a>
<a class="sourceLine" id="cb1002-4" title="4">    outputted_csv &lt;-<span class="st"> </span>files_example <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1002-5" title="5"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">csv_data =</span> <span class="kw">map</span>(file_paths, <span class="kw">safely</span>(read_csv)))</a></code></pre></div>
</div>
<div id="plot-of-names" class="section level4">
<h4>Plot of names</h4>
<ul>
<li>Below is a plot of the proportion of individuals named the most popular letter in each year. This suggests that the top names by letter do not have as large of a proportion of the population ocmpared to historically.</li>
</ul>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1003-1" title="1">names_appended <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1003-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> prop, <span class="dt">colour =</span> first_letter))<span class="op">+</span></a>
<a class="sourceLine" id="cb1003-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="21-iteration_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="csv-other-example" class="section level4">
<h4>csv other example</h4>
<p>The code below might be used to read csvs from a shared drive. I added on the ‘file_path_pull’ and ‘files_example’ components to add in information on the file paths and other details that were relevant. You might also add this data into a new column on the output…</p>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1004-1" title="1">files_path_pull &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;//companydomain.com/directory/&quot;</span>, </a>
<a class="sourceLine" id="cb1004-2" title="2">                       <span class="dt">pattern =</span> <span class="st">&quot;csv$&quot;</span>,</a>
<a class="sourceLine" id="cb1004-3" title="3">                       <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1004-4" title="4"></a>
<a class="sourceLine" id="cb1004-5" title="5">files_example &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">file_paths =</span> files_path_pull[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1004-6" title="6"><span class="st">  </span><span class="kw">extract</span>(file_paths, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;path&quot;</span>, <span class="st">&quot;name&quot;</span>), <span class="dt">regex =</span> <span class="st">&quot;(.*)([0-9]{4}-[0-9]{2}-[0-9]{2})&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1004-7" title="7"></a>
<a class="sourceLine" id="cb1004-8" title="8">read_dir &lt;-<span class="st"> </span><span class="cf">function</span>(dir){</a>
<a class="sourceLine" id="cb1004-9" title="9">  <span class="co">#input vector of file paths name and output appended file</span></a>
<a class="sourceLine" id="cb1004-10" title="10">  out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(dir))</a>
<a class="sourceLine" id="cb1004-11" title="11">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(out)){</a>
<a class="sourceLine" id="cb1004-12" title="12">    out[[i]] &lt;-<span class="st"> </span><span class="kw">read_csv</span>(dir[[i]])</a>
<a class="sourceLine" id="cb1004-13" title="13">  }</a>
<a class="sourceLine" id="cb1004-14" title="14">  out &lt;-<span class="st">  </span><span class="kw">bind_rows</span>(out)</a>
<a class="sourceLine" id="cb1004-15" title="15">  out</a>
<a class="sourceLine" id="cb1004-16" title="16">}</a>
<a class="sourceLine" id="cb1004-17" title="17"></a>
<a class="sourceLine" id="cb1004-18" title="18"><span class="kw">read_dir</span>(files_example<span class="op">$</span>file_paths)</a></code></pre></div>
</div>
</div>
<div id="with-purrr" class="section level3">
<h3>21.3.5.2 (with purrr)</h3>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1005-1" title="1">purrr<span class="op">::</span><span class="kw">map_lgl</span>(iris, is.factor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1005-2" title="2"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">enframe</span>()</a></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   name         value
##   &lt;chr&gt;        &lt;lgl&gt;
## 1 Sepal.Length FALSE
## 2 Sepal.Width  FALSE
## 3 Petal.Length FALSE
## 4 Petal.Width  FALSE
## 5 Species      TRUE</code></pre>
<p>Slightly less attractive printing</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1007-1" title="1">show_mean2 &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb1007-2" title="2">  df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1007-3" title="3"><span class="st">    </span><span class="kw">keep</span>(is.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1007-4" title="4"><span class="st">    </span><span class="kw">map_dbl</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1007-5" title="5">}</a>
<a class="sourceLine" id="cb1007-6" title="6"></a>
<a class="sourceLine" id="cb1007-7" title="7"><span class="kw">show_mean2</span>(flights)</a></code></pre></div>
<pre><code>##           year          month            day       dep_time sched_dep_time 
##    2013.000000       6.548510      15.710787    1349.109947    1344.254840 
##      dep_delay       arr_time sched_arr_time      arr_delay         flight 
##      12.639070    1502.054999    1536.380220       6.895377    1971.923620 
##       air_time       distance           hour         minute 
##     150.686460    1039.912604      13.180247      26.230100</code></pre>
<p>Maybe slightly better printing and in df</p>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1009-1" title="1">show_mean3 &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb1009-2" title="2">  df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-3" title="3"><span class="st">    </span><span class="kw">keep</span>(is.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-4" title="4"><span class="st">    </span><span class="kw">map_dbl</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-5" title="5"><span class="st">    </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-6" title="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">names =</span> <span class="kw">row.names</span>(.))</a>
<a class="sourceLine" id="cb1009-7" title="7">}</a>
<a class="sourceLine" id="cb1009-8" title="8"></a>
<a class="sourceLine" id="cb1009-9" title="9"><span class="kw">show_mean3</span>(flights)</a></code></pre></div>
<pre><code>## Warning: Calling `as_tibble()` on a vector is discouraged, because the behavior is likely to change in the future. Use `enframe(name = NULL)` instead.
## This warning is displayed once per session.</code></pre>
<pre><code>## # A tibble: 14 x 2
##      value names
##      &lt;dbl&gt; &lt;chr&gt;
##  1 2013    1    
##  2    6.55 2    
##  3   15.7  3    
##  4 1349.   4    
##  5 1344.   5    
##  6   12.6  6    
##  7 1502.   7    
##  8 1536.   8    
##  9    6.90 9    
## 10 1972.   10   
## 11  151.   11   
## 12 1040.   12   
## 13   13.2  13   
## 14   26.2  14</code></pre>
<p>Other method is to take advantage of the <code>gather()</code> function</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1012-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1012-2" title="2"><span class="st">  </span><span class="kw">keep</span>(is.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1012-3" title="3"><span class="st">  </span><span class="kw">map</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1012-4" title="4"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1012-5" title="5"><span class="st">  </span><span class="kw">gather</span>()</a></code></pre></div>
<pre><code>## # A tibble: 14 x 2
##    key              value
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 year           2013   
##  2 month             6.55
##  3 day              15.7 
##  4 dep_time       1349.  
##  5 sched_dep_time 1344.  
##  6 dep_delay        12.6 
##  7 arr_time       1502.  
##  8 sched_arr_time 1536.  
##  9 arr_delay         6.90
## 10 flight         1972.  
## 11 air_time        151.  
## 12 distance       1040.  
## 13 hour             13.2 
## 14 minute           26.2</code></pre>
</div>
<div id="section-83" class="section level3">
<h3>21.9.3.1</h3>
<ul>
<li>mine can’t handle shortcut formulas or new functions</li>
</ul>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1014-1" title="1">z &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1014-2" title="2">z <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1014-3" title="3"><span class="st">  </span><span class="kw">every</span>( <span class="op">~</span><span class="st"> </span>. <span class="op">&lt;</span><span class="st"> </span><span class="dv">11</span>)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1016-1" title="1"><span class="co"># e.g. below would fail</span></a>
<a class="sourceLine" id="cb1016-2" title="2"><span class="co"># z %&gt;%</span></a>
<a class="sourceLine" id="cb1016-3" title="3"><span class="co">#   every_loop( ~ . &lt; 11)</span></a></code></pre></div>
</div>
<div id="mirroring-keep" class="section level3">
<h3>21.9 mirroring <code>keep</code></h3>
<ul>
<li><p>below is one method for passing multiple, more complex arguments through keep, though you can also use function shortcuts (<code>~</code>) in <code>keep</code> and <code>discard</code></p>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1017-1" title="1"><span class="co">##how to pass multiple functions through keep?</span></a>
<a class="sourceLine" id="cb1017-2" title="2"><span class="co">#can use map to subset columns by multiple criteria and then subset at end</span></a>
<a class="sourceLine" id="cb1017-3" title="3">flights <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1017-4" title="4"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>(is.na) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1017-5" title="5"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map_dbl</span>(sum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1017-6" title="6"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map_lgl</span>(<span class="op">~</span>.<span class="op">&gt;</span><span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1017-7" title="7"><span class="st">  </span>flights[.]</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 6
##    dep_time dep_delay arr_time arr_delay tailnum air_time
##       &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1      517         2      830        11 N14228       227
##  2      533         4      850        20 N24211       227
##  3      542         2      923        33 N619AA       160
##  4      544        -1     1004       -18 N804JB       183
##  5      554        -6      812       -25 N668DN       116
##  6      554        -4      740        12 N39463       150
##  7      555        -5      913        19 N516JB       158
##  8      557        -3      709       -14 N829AS        53
##  9      557        -3      838        -8 N593JB       140
## 10      558        -2      753         8 N3ALAA       138
## # ... with 336,766 more rows</code></pre></li>
</ul>
</div>
<div id="invoke-examples" class="section level3">
<h3>invoke examples</h3>
<p>Let’s change the example to be with quantile…</p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1019-1" title="1"><span class="kw">invoke</span>(runif, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>##  [1] 0.775555937 0.328805817 0.920314980 0.176599637 0.210958651
##  [6] 0.890200325 0.456075735 0.498955991 0.148438198 0.001021321</code></pre>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1021-1" title="1"><span class="kw">list</span>(<span class="st">&quot;01a&quot;</span>, <span class="st">&quot;01b&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1021-2" title="2"><span class="st">  </span><span class="kw">invoke</span>(paste, ., <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;01a-01b&quot;</code></pre>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1023-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1023-2" title="2"><span class="kw">invoke_map</span>(<span class="kw">list</span>(runif, rnorm), <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">10</span>), <span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">5</span>)))</a></code></pre></div>
<pre><code>## [[1]]
##  [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673 0.0455565 0.5281055
##  [8] 0.8924190 0.5514350 0.4566147
## 
## [[2]]
## [1]  1.7150650  0.4609162 -1.2650612 -0.6868529 -0.4456620</code></pre>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1025-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1025-2" title="2"><span class="kw">invoke_map</span>(<span class="kw">list</span>(runif, rnorm), <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">10</span>), <span class="kw">list</span>(<span class="dv">5</span>, <span class="dv">50</span>)))</a></code></pre></div>
<pre><code>## [[1]]
##  [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673 0.0455565 0.5281055
##  [8] 0.8924190 0.5514350 0.4566147
## 
## [[2]]
## [1] 51.71506 50.46092 48.73494 49.31315 49.55434</code></pre>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1027-1" title="1"><span class="kw">list</span>(<span class="dt">m1 =</span> mean, <span class="dt">m2 =</span> median) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">invoke_map</span>(<span class="dt">x =</span> <span class="kw">rcauchy</span>(<span class="dv">100</span>))</a></code></pre></div>
<pre><code>## $m1
## [1] 0.7316016
## 
## $m2
## [1] 0.1690467</code></pre>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1029-1" title="1"><span class="kw">rcauchy</span>(<span class="dv">100</span>)</a></code></pre></div>
<pre><code>##   [1]   -1.99514216    1.57378677    1.44901985    0.82604308    2.30072052
##   [6]   -0.04961749    0.52626840    0.29408692    0.47790231   -1.47138470
##  [11]   -2.54305059   -0.35508248   -1.65511601   -1.08467708  -15.03813728
##  [16]   -1.82118206   -0.62669137   -0.79456204   -0.06347636    5.19179251
##  [21]    1.48851593    3.42095041    0.03289526    0.65171559   -0.53864091
##  [26]    0.88812626    0.93375555    0.24570517    0.97348569   -1.11905466
##  [31]   -0.51964526  128.72537963    2.72138263    0.97793363    0.36391811
##  [36]    2.77745450   -4.34935786    0.81096079    5.70518746    0.81669440
##  [41] -138.41947905    2.02359725   -1.96283674    2.40809060    2.04850398
##  [46]   -9.41347275   -1.06265274    0.83312509    3.55625549    1.10375978
##  [51]   -2.31140048    0.65162145   -0.45665528   -1.02179975   -1.71189590
##  [56]   -2.57239721    2.35617831  -10.63750166   -0.41538322   -3.80770683
##  [61]   -0.55070513    1.49607830   -1.30359005    1.09910916   -3.27457763
##  [66]   16.99304208    1.09921270   -4.86030197   -0.27969649   -0.31842181
##  [71]    1.16466121    1.59209243   -0.04514112   -2.52586678   -0.19951960
##  [76]    9.47599952    3.31841045   -1.82945785    0.51884667   -4.29179059
##  [81]    0.93155898   -0.11880720   -3.03333758  -21.16294537    3.16450655
##  [86]   -0.39503234    2.19801293    1.27457150    0.59413768    0.60064481
##  [91]   17.70703023    1.01880490    0.80764382   -1.63905090    0.15086898
##  [96]   -1.36865319    1.99173761    3.39988162   -0.63043489   -0.26058630</code></pre>
<p>Let’s store everything in a dataframe…</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1031-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1031-2" title="2"><span class="kw">tibble</span>(<span class="dt">funs =</span> <span class="kw">list</span>(<span class="dt">rn =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="dt">rp =</span> <span class="st">&quot;rpois&quot;</span>, <span class="dt">ru =</span> <span class="st">&quot;runif&quot;</span>),</a>
<a class="sourceLine" id="cb1031-3" title="3">       <span class="dt">params =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">10</span>), <span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">lambda =</span> <span class="dv">3</span>), <span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1031-4" title="4"><span class="st">  </span><span class="kw">with</span>(<span class="kw">invoke_map_df</span>(funs, params))</a></code></pre></div>
<pre><code>## # A tibble: 20 x 3
##       rn    rp      ru
##    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
##  1  9.44     1  0.330 
##  2  9.77     2 -0.810 
##  3 11.6      2 -0.232 
##  4 10.1      2 -0.451 
##  5 10.1      1  0.629 
##  6 11.7      1 -0.103 
##  7 10.5      2  0.620 
##  8  8.73     3  0.625 
##  9  9.31     2  0.589 
## 10  9.55     5 -0.120 
## 11 11.2      0  0.509 
## 12 10.4      3  0.258 
## 13 10.4      4  0.420 
## 14 10.1      1 -0.999 
## 15  9.44     3 -0.0494
## 16 11.8      2 -0.560 
## 17 10.5      1 -0.240 
## 18  8.03     4  0.226 
## 19 10.7      5 -0.296 
## 20  9.53     2 -0.778</code></pre>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1033-1" title="1"><span class="kw">map_df</span>(iris, <span class="op">~</span>.x<span class="op">*</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Warning in Ops.factor(.x, 2): &#39;*&#39; not meaningful for factors</code></pre>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;  
##  1         10.2         7            2.8         0.4 NA     
##  2          9.8         6            2.8         0.4 NA     
##  3          9.4         6.4          2.6         0.4 NA     
##  4          9.2         6.2          3           0.4 NA     
##  5         10           7.2          2.8         0.4 NA     
##  6         10.8         7.8          3.4         0.8 NA     
##  7          9.2         6.8          2.8         0.6 NA     
##  8         10           6.8          3           0.4 NA     
##  9          8.8         5.8          2.8         0.4 NA     
## 10          9.8         6.2          3           0.2 NA     
## # ... with 140 more rows</code></pre>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1036-1" title="1"><span class="kw">select</span>(iris, <span class="op">-</span>Species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1036-2" title="2"><span class="st">  </span><span class="kw">flatten_dbl</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1036-3" title="3"><span class="st">  </span><span class="kw">mean</span>()</a></code></pre></div>
<pre><code>## [1] 3.4645</code></pre>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1038-1" title="1">mean.and.median &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb1038-2" title="2">  <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb1038-3" title="3">       <span class="dt">median =</span> <span class="kw">median</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1038-4" title="4">}</a></code></pre></div>
<p>Difference between dfr and dfc, taken from here: <a href="https://bio304-class.github.io/bio304-fall2017/control-flow-in-R.html" class="uri">https://bio304-class.github.io/bio304-fall2017/control-flow-in-R.html</a></p>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1039-1" title="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1039-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1039-3" title="3"><span class="st">  </span><span class="kw">map_dfr</span>(mean.and.median) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1039-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">tibble</span>(<span class="dt">names =</span> <span class="kw">names</span>(<span class="kw">select</span>(iris, <span class="op">-</span>Species))))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##    mean median names       
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       
## 1  5.84   5.8  Sepal.Length
## 2  3.06   3    Sepal.Width 
## 3  3.76   4.35 Petal.Length
## 4  1.20   1.3  Petal.Width</code></pre>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1041-1" title="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1041-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1041-3" title="3"><span class="st">  </span><span class="kw">map_dfr</span>(mean.and.median) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1041-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">tibble</span>(<span class="dt">names =</span> <span class="kw">names</span>(<span class="kw">select</span>(iris, <span class="op">-</span>Species))))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##    mean median names       
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       
## 1  5.84   5.8  Sepal.Length
## 2  3.06   3    Sepal.Width 
## 3  3.76   4.35 Petal.Length
## 4  1.20   1.3  Petal.Width</code></pre>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1043-1" title="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1043-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1043-3" title="3"><span class="st">  </span><span class="kw">map_dfc</span>(mean.and.median)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 8
##    mean median mean1 median1 mean2 median2 mean3 median3
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1  5.84    5.8  3.06       3  3.76    4.35  1.20     1.3</code></pre>
</div>
<div id="indexing-nms-caution" class="section level3">
<h3>indexing nms caution</h3>
<p>When creating your empty list, use indexes rather than names if you are creating values, otherwise you are creating new values on the list. E.g. in the example below I the output ends up being length 6 because you have the 3 <code>NULL</code> values plus the 3 newly created named positions.</p>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1045-1" title="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">11</span><span class="op">:</span><span class="dv">18</span>, <span class="dt">c =</span> <span class="dv">19</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb1045-2" title="2">output &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb1045-3" title="3"><span class="cf">for</span> (nm <span class="cf">in</span> <span class="kw">names</span>(x)) {</a>
<a class="sourceLine" id="cb1045-4" title="4">  output[[nm]] &lt;-<span class="st"> </span>x[[nm]] <span class="op">*</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1045-5" title="5">}</a>
<a class="sourceLine" id="cb1045-6" title="6">output</a></code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## $a
##  [1]  3  6  9 12 15 18 21 24 27 30
## 
## $b
## [1] 33 36 39 42 45 48 51 54
## 
## $c
## [1] 57 60 63 66 69 72 75</code></pre>
</div>
<div id="in-class-notes" class="section level3">
<h3>in-class notes</h3>
<p>the <code>map_*</code> functions are essentially like running a <code>flatten_*</code> after running <code>map</code>. E.g. the two things below are equivalent</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1047-1" title="1"><span class="kw">map</span>(flights, typeof) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1047-2" title="2"><span class="st">  </span><span class="kw">flatten_chr</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;   &quot;integer&quot;  
##  [6] &quot;double&quot;    &quot;integer&quot;   &quot;integer&quot;   &quot;double&quot;    &quot;character&quot;
## [11] &quot;integer&quot;   &quot;character&quot; &quot;character&quot; &quot;character&quot; &quot;double&quot;   
## [16] &quot;double&quot;    &quot;double&quot;    &quot;double&quot;    &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1049-1" title="1"><span class="kw">map_chr</span>(flights, typeof)</a></code></pre></div>
<pre><code>##           year          month            day       dep_time sched_dep_time 
##      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot;      &quot;integer&quot; 
##      dep_delay       arr_time sched_arr_time      arr_delay        carrier 
##       &quot;double&quot;      &quot;integer&quot;      &quot;integer&quot;       &quot;double&quot;    &quot;character&quot; 
##         flight        tailnum         origin           dest       air_time 
##      &quot;integer&quot;    &quot;character&quot;    &quot;character&quot;    &quot;character&quot;       &quot;double&quot; 
##       distance           hour         minute      time_hour 
##       &quot;double&quot;       &quot;double&quot;       &quot;double&quot;       &quot;double&quot;</code></pre>
<p>Calculate the number of unique values for each level</p>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1051-1" title="1">iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1051-2" title="2"><span class="st">  </span><span class="kw">map</span>(unique) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1051-3" title="3"><span class="st">  </span><span class="kw">map_dbl</span>(length)</a>
<a class="sourceLine" id="cb1051-4" title="4"></a>
<a class="sourceLine" id="cb1051-5" title="5"><span class="kw">map_int</span>(iris, <span class="op">~</span><span class="kw">length</span>(<span class="kw">unique</span>(.x)))</a></code></pre></div>
<p>Iterate through different min and max values</p>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1052-1" title="1">min_params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-10</span>)</a>
<a class="sourceLine" id="cb1052-2" title="2">max_params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span><span class="op">:</span><span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1052-3" title="3"><span class="kw">map2</span>(<span class="dt">.x =</span> min_params, <span class="dt">.y =</span> max_params, <span class="op">~</span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">min =</span> .x, <span class="dt">max =</span> .y))</a></code></pre></div>
<pre><code>## [[1]]
##  [1]  1.9234337  7.0166670  4.0117614  8.4583500  0.2343757  4.2187129
##  [7] 10.8194838  9.7166134  9.6376287  1.1006318
## 
## [[2]]
##  [1] 1.568348 7.837223 4.122198 7.881098 3.844479 2.252293 9.387532
##  [8] 1.123140 5.601348 6.138066
## 
## [[3]]
##  [1]  3.7997461 -2.3450586  1.2380998 11.9528980  1.1067551 10.4780551
##  [7] 11.0320783  4.0009046 -0.5541351 -6.6168221</code></pre>
<p>When using <code>pmap</code> it’s often best to keep the parameters in a dataframe</p>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1054-1" title="1">min_df_params &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">50</span> ), </a>
<a class="sourceLine" id="cb1054-2" title="2">                        <span class="dt">min =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb1054-3" title="3">                        <span class="dt">max =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1054-4" title="4"></a>
<a class="sourceLine" id="cb1054-5" title="5"><span class="kw">pmap</span>(min_df_params, runif)</a></code></pre></div>
<pre><code>## [[1]]
##  [1] -0.06470020 -0.69877110 -0.93927943 -0.05227306 -0.27940373
##  [6] -0.85770570 -0.45071534 -0.04590876 -0.41451665 -0.59548972
## 
## [[2]]
##  [1] 0.6478935 0.3198206 0.3077200 0.2197676 0.3694889 0.9842192 0.1542023
##  [8] 0.0910440 0.1419069 0.6900071 0.6192565 0.8913941 0.6729991 0.7370777
## [15] 0.5211357
## 
## [[3]]
##  [1] 1.659838 1.821805 1.786282 1.979822 1.439432 1.311702 1.409475
##  [8] 1.010467 1.183850 1.842729 1.231162 1.239100 1.076691 1.245724
## [15] 1.732135 1.847453 1.497527 1.387909 1.246449 1.111096
## 
## [[4]]
##  [1] 2.389994 2.571935 2.216893 2.444768 2.217991 2.502300 2.353905
##  [8] 2.649985 2.374714 2.355445 2.533688 2.740334 2.221103 2.412746
## [15] 2.265687 2.629973 2.183828 2.863644 2.746568 2.668285 2.618018
## [22] 2.372238 2.529836 2.874682 2.581750 2.839768 2.312448 2.708290
## [29] 2.265018 2.594343 2.481290 2.265033 2.564590 2.913188 2.901874
## [36] 2.274167 2.321483 2.985641 2.619993 2.937314 2.466533 2.406833
## [43] 2.659230 2.152347 2.572867 2.238726 2.962359 2.601366 2.515030
## [50] 2.402573</code></pre>
<p>You can often use <code>map</code> a bunch of output that can then be stored in a tibble</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1056-1" title="1"><span class="kw">tibble</span>(<span class="dt">type =</span> <span class="kw">map_chr</span>(mtcars, typeof),</a>
<a class="sourceLine" id="cb1056-2" title="2">       <span class="dt">means =</span> <span class="kw">map_dbl</span>(mtcars, mean),</a>
<a class="sourceLine" id="cb1056-3" title="3">       <span class="dt">median =</span> <span class="kw">map_dbl</span>(mtcars, median),</a>
<a class="sourceLine" id="cb1056-4" title="4">       <span class="dt">names =</span> <span class="kw">names</span>(mtcars))</a></code></pre></div>
<pre><code>## # A tibble: 11 x 4
##    type     means median names
##    &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;
##  1 double  20.1    19.2  mpg  
##  2 double   6.19    6    cyl  
##  3 double 231.    196.   disp 
##  4 double 147.    123    hp   
##  5 double   3.60    3.70 drat 
##  6 double   3.22    3.32 wt   
##  7 double  17.8    17.7  qsec 
##  8 double   0.438   0    vs   
##  9 double   0.406   0    am   
## 10 double   3.69    4    gear 
## 11 double   2.81    2    carb</code></pre>
<p><em>Provide the number of unique values for all columns excluding columns with numeric types or date types.</em></p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1058-1" title="1">num_unique &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb1058-2" title="2">  df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1058-3" title="3"><span class="st">  </span><span class="kw">keep</span>(<span class="op">~</span><span class="kw">is_character</span>(.x) <span class="op">|</span><span class="st"> </span><span class="kw">is.factor</span>(.x)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1058-4" title="4"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">length</span>(<span class="kw">unique</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1058-5" title="5"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1058-6" title="6"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1058-7" title="7"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">field_name =</span> key, <span class="dt">num_unique =</span> value)</a>
<a class="sourceLine" id="cb1058-8" title="8">}</a>
<a class="sourceLine" id="cb1058-9" title="9"></a>
<a class="sourceLine" id="cb1058-10" title="10"><span class="kw">num_unique</span>(flights)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   field_name num_unique
##   &lt;chr&gt;           &lt;int&gt;
## 1 carrier            16
## 2 tailnum          4044
## 3 origin              3
## 4 dest              105</code></pre>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1060-1" title="1"><span class="kw">num_unique</span>(iris)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   field_name num_unique
##   &lt;chr&gt;           &lt;int&gt;
## 1 Species             3</code></pre>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1062-1" title="1"><span class="kw">num_unique</span>(mpg)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   field_name   num_unique
##   &lt;chr&gt;             &lt;int&gt;
## 1 manufacturer         15
## 2 model                38
## 3 trans                10
## 4 drv                   3
## 5 fl                    5
## 6 class                 7</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="36">
<li id="fn36"><p>This is a very powerful practice because it allows you to save / keep track of your manipulations and apply them at other locations, while keeping the logic very well organized – go and use this for documenting your work / transformations<a href="21-iteration.html#fnref36" class="footnote-back">↩</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//brshallo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the
<a href="https://disqus.com/?ref_noscript">
  comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="20-vectors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="23-model-basics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"instapaper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https\://github.com/brshallow/R4DS_Solutions/edit/master/21-iteration.Rmd",
"text": "Edit, fork"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
