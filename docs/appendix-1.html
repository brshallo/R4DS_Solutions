<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Another set of solutions to ‘R for Data Science’</title>
  <meta name="description" content="My notes and solutions to ‘R for Data Science’ by Garrett Grolemund and Hadley Wickham">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Another set of solutions to ‘R for Data Science’" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes and solutions to ‘R for Data Science’ by Garrett Grolemund and Hadley Wickham" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Another set of solutions to ‘R for Data Science’" />
  
  <meta name="twitter:description" content="My notes and solutions to ‘R for Data Science’ by Garrett Grolemund and Hadley Wickham" />
  

<meta name="author" content="Bryan Shalloway">


<meta name="date" content="2019-05-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ch-5-data-transformations.html">
<link rel="next" href="ch-7-data-exploration.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.3.1/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Book contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Purpose of this book</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#features-of-this-book"><i class="fa fa-check"></i><b>1.1</b> Features of this book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#origin-of-this-book"><i class="fa fa-check"></i><b>1.2</b> Origin of this book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#plug-for-r4ds"><i class="fa fa-check"></i><b>1.3</b> Plug for R4DS</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#plug-for-r4ds-1"><i class="fa fa-check"></i><b>1.4</b> Plug for R4DS</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html"><i class="fa fa-check"></i><b>2</b> ch 3: Data visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#first-steps"><i class="fa fa-check"></i><b>2.1</b> 3.2: First steps</a><ul>
<li class="chapter" data-level="2.1.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section"><i class="fa fa-check"></i><b>2.1.1</b> 3.2.4</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#aesthetic-mappings"><i class="fa fa-check"></i><b>2.2</b> 3.3: Aesthetic mappings</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-1"><i class="fa fa-check"></i><b>2.2.1</b> 3.3.1.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#facets"><i class="fa fa-check"></i><b>2.3</b> 3.5: Facets</a><ul>
<li class="chapter" data-level="2.3.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-2"><i class="fa fa-check"></i><b>2.3.1</b> 3.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#geometric-objects"><i class="fa fa-check"></i><b>2.4</b> 3.6: Geometric Objects</a><ul>
<li class="chapter" data-level="2.4.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-3"><i class="fa fa-check"></i><b>2.4.1</b> 3.6.1</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#statistical-transformations"><i class="fa fa-check"></i><b>2.5</b> 3.7: statistical transformations</a><ul>
<li class="chapter" data-level="2.5.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-4"><i class="fa fa-check"></i><b>2.5.1</b> 3.7.1.</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#position-adjjustment"><i class="fa fa-check"></i><b>2.6</b> 3.8: Position Adjjustment</a><ul>
<li class="chapter" data-level="2.6.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-5"><i class="fa fa-check"></i><b>2.6.1</b> 3.8.1.</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#coordinate-systems"><i class="fa fa-check"></i><b>2.7</b> 3.9: Coordinate systems</a><ul>
<li class="chapter" data-level="2.7.1" data-path="ch-3-data-visualization.html"><a href="ch-3-data-visualization.html#section-6"><i class="fa fa-check"></i><b>2.7.1</b> 3.9.1.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>3</b> Appendix</a><ul>
<li class="chapter" data-level="3.1" data-path="appendix.html"><a href="appendix.html#extension"><i class="fa fa-check"></i><b>3.1</b> 3.7.1.1 extension</a></li>
<li class="chapter" data-level="3.2" data-path="appendix.html"><a href="appendix.html#position-adustments"><i class="fa fa-check"></i><b>3.2</b> 3.8: Position adustments</a></li>
<li class="chapter" data-level="3.3" data-path="appendix.html"><a href="appendix.html#coordinate-systems-1"><i class="fa fa-check"></i><b>3.3</b> 3.9: Coordinate systems</a></li>
<li class="chapter" data-level="3.4" data-path="appendix.html"><a href="appendix.html#add-in-table-of-contents-and-other-details"><i class="fa fa-check"></i><b>3.4</b> add in table of contents and other details…</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html"><i class="fa fa-check"></i><b>4</b> ch. 5 Data transformations</a><ul>
<li class="chapter" data-level="4.1" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#filter-rows"><i class="fa fa-check"></i><b>4.1</b> 5.2: Filter rows</a></li>
<li class="chapter" data-level="4.2" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#section-7"><i class="fa fa-check"></i><b>4.2</b> 5.2.4.</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#section-8"><i class="fa fa-check"></i><b>4.2.1</b> 5.3.1.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#grouped-summaries"><i class="fa fa-check"></i><b>4.3</b> 5.6: Grouped summaries</a><ul>
<li class="chapter" data-level="4.3.1" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#section-9"><i class="fa fa-check"></i><b>4.3.1</b> 5.6.7.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#grouped-mutates-and-filters"><i class="fa fa-check"></i><b>4.4</b> Grouped mutates (and filters)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="ch-5-data-transformations.html"><a href="ch-5-data-transformations.html#section-10"><i class="fa fa-check"></i><b>4.4.1</b> 5.7.1.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="appendix-1.html"><a href="appendix-1.html"><i class="fa fa-check"></i><b>5</b> Appendix</a><ul>
<li class="chapter" data-level="5.1" data-path="appendix-1.html"><a href="appendix-1.html#section-11"><i class="fa fa-check"></i><b>5.1</b> 5.4.1.3.</a></li>
<li class="chapter" data-level="5.2" data-path="appendix-1.html"><a href="appendix-1.html#section-12"><i class="fa fa-check"></i><b>5.2</b> 5.5.2.1.</a></li>
<li class="chapter" data-level="5.3" data-path="appendix-1.html"><a href="appendix-1.html#section-13"><i class="fa fa-check"></i><b>5.3</b> 5.5.2.2</a><ul>
<li class="chapter" data-level="5.3.1" data-path="appendix-1.html"><a href="appendix-1.html#closer-look-at-air_time"><i class="fa fa-check"></i><b>5.3.1</b> Closer look at <code>air_time</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="appendix-1.html"><a href="appendix-1.html#other-plots-with-air_time"><i class="fa fa-check"></i><b>5.3.2</b> Other plots with <code>air_time</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="appendix-1.html"><a href="appendix-1.html#section-14"><i class="fa fa-check"></i><b>5.4</b> 5.6.7.1.</a></li>
<li class="chapter" data-level="5.5" data-path="appendix-1.html"><a href="appendix-1.html#section-15"><i class="fa fa-check"></i><b>5.5</b> 5.6.7.4.</a></li>
<li class="chapter" data-level="5.6" data-path="appendix-1.html"><a href="appendix-1.html#section-16"><i class="fa fa-check"></i><b>5.6</b> 5.6.7.5.</a><ul>
<li class="chapter" data-level="5.6.1" data-path="appendix-1.html"><a href="appendix-1.html#modeling-approach"><i class="fa fa-check"></i><b>5.6.1</b> Modeling approach</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="appendix-1.html"><a href="appendix-1.html#section-17"><i class="fa fa-check"></i><b>5.7</b> 5.6.7.6.</a></li>
<li class="chapter" data-level="5.8" data-path="appendix-1.html"><a href="appendix-1.html#section-18"><i class="fa fa-check"></i><b>5.8</b> 5.7.1.6.</a></li>
<li class="chapter" data-level="5.9" data-path="appendix-1.html"><a href="appendix-1.html#section-19"><i class="fa fa-check"></i><b>5.9</b> 5.7.1.5</a></li>
<li class="chapter" data-level="5.10" data-path="appendix-1.html"><a href="appendix-1.html#section-20"><i class="fa fa-check"></i><b>5.10</b> 5.7.1.8.</a></li>
<li class="chapter" data-level="5.11" data-path="appendix-1.html"><a href="appendix-1.html#other"><i class="fa fa-check"></i><b>5.11</b> Other</a><ul>
<li class="chapter" data-level="5.11.1" data-path="appendix-1.html"><a href="appendix-1.html#on-piping-dots"><i class="fa fa-check"></i><b>5.11.1</b> On piping dots</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="appendix-1.html"><a href="appendix-1.html#plotly"><i class="fa fa-check"></i><b>5.12</b> plotly</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html"><i class="fa fa-check"></i><b>6</b> ch. 7: Data exploration</a><ul>
<li class="chapter" data-level="6.1" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#variation"><i class="fa fa-check"></i><b>6.1</b> 7.3. Variation</a><ul>
<li class="chapter" data-level="6.1.1" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#section-21"><i class="fa fa-check"></i><b>6.1.1</b> 7.3.4.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#missing-values"><i class="fa fa-check"></i><b>6.2</b> 7.4. Missing values</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#section-22"><i class="fa fa-check"></i><b>6.2.1</b> 7.4.1.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#covariation"><i class="fa fa-check"></i><b>6.3</b> 7.5. Covariation</a><ul>
<li class="chapter" data-level="6.3.1" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#section-23"><i class="fa fa-check"></i><b>6.3.1</b> 7.5.1.1.</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#section-24"><i class="fa fa-check"></i><b>6.3.2</b> 7.5.2.1.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#two-continuous-variables"><i class="fa fa-check"></i><b>6.4</b> 7.5.3 Two continuous variables</a><ul>
<li class="chapter" data-level="6.4.1" data-path="ch-7-data-exploration.html"><a href="ch-7-data-exploration.html#section-25"><i class="fa fa-check"></i><b>6.4.1</b> 7.5.3.1.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="appendix-2.html"><a href="appendix-2.html"><i class="fa fa-check"></i><b>7</b> Appendix</a><ul>
<li class="chapter" data-level="7.1" data-path="appendix-2.html"><a href="appendix-2.html#section-26"><i class="fa fa-check"></i><b>7.1</b> 7.5.2.1.2.</a></li>
<li class="chapter" data-level="7.2" data-path="appendix-2.html"><a href="appendix-2.html#section-27"><i class="fa fa-check"></i><b>7.2</b> 7.5.3.1.4.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-10-tibbles.html"><a href="ch-10-tibbles.html"><i class="fa fa-check"></i><b>8</b> ch. 10: Tibbles</a><ul>
<li class="chapter" data-level="8.1" data-path="ch-10-tibbles.html"><a href="ch-10-tibbles.html#section-28"><i class="fa fa-check"></i><b>8.1</b> 10.5</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-11-data-import.html"><a href="ch-11-data-import.html"><i class="fa fa-check"></i><b>9</b> ch. 11: Data import</a><ul>
<li class="chapter" data-level="9.1" data-path="ch-11-data-import.html"><a href="ch-11-data-import.html#section-29"><i class="fa fa-check"></i><b>9.1</b> 11.2.2.</a></li>
<li class="chapter" data-level="9.2" data-path="ch-11-data-import.html"><a href="ch-11-data-import.html#section-30"><i class="fa fa-check"></i><b>9.2</b> 11.3.5.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html"><i class="fa fa-check"></i><b>10</b> ch. 12: Tidy data</a><ul>
<li class="chapter" data-level="10.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#tidy-data"><i class="fa fa-check"></i><b>10.1</b> 12.2: Tidy data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#section-31"><i class="fa fa-check"></i><b>10.1.1</b> 12.2.1.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#spreading-and-gathering"><i class="fa fa-check"></i><b>10.2</b> 12.3: Spreading and gathering</a><ul>
<li class="chapter" data-level="10.2.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#section-32"><i class="fa fa-check"></i><b>10.2.1</b> 12.3.3.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#separating-and-uniting"><i class="fa fa-check"></i><b>10.3</b> 12.4: Separating and uniting</a><ul>
<li class="chapter" data-level="10.3.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#section-33"><i class="fa fa-check"></i><b>10.3.1</b> 12.4.3.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#missing-values-1"><i class="fa fa-check"></i><b>10.4</b> 12.5: missing values</a><ul>
<li class="chapter" data-level="10.4.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#section-34"><i class="fa fa-check"></i><b>10.4.1</b> 12.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#case-study"><i class="fa fa-check"></i><b>10.5</b> 12.6 Case Study</a><ul>
<li class="chapter" data-level="10.5.1" data-path="ch-12-tidy-data.html"><a href="ch-12-tidy-data.html#section-35"><i class="fa fa-check"></i><b>10.5.1</b> 12.6.1.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html"><i class="fa fa-check"></i><b>11</b> ch. 13: Relational data</a><ul>
<li class="chapter" data-level="11.1" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#nycflights13"><i class="fa fa-check"></i><b>11.1</b> 13.2 nycflights13</a><ul>
<li class="chapter" data-level="11.1.1" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#section-36"><i class="fa fa-check"></i><b>11.1.1</b> 13.2.1</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#keys"><i class="fa fa-check"></i><b>11.2</b> 13.3 Keys</a><ul>
<li class="chapter" data-level="11.2.1" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#section-37"><i class="fa fa-check"></i><b>11.2.1</b> 13.3.1</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#mutating-joins"><i class="fa fa-check"></i><b>11.3</b> 13.4 Mutating joins</a><ul>
<li class="chapter" data-level="11.3.1" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#section-38"><i class="fa fa-check"></i><b>11.3.1</b> 13.4.6</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#filtering-joins"><i class="fa fa-check"></i><b>11.4</b> 13.5 Filtering joins</a><ul>
<li class="chapter" data-level="11.4.1" data-path="ch-13-relational-data.html"><a href="ch-13-relational-data.html#section-39"><i class="fa fa-check"></i><b>11.4.1</b> 13.5.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-14-strings.html"><a href="ch-14-strings.html"><i class="fa fa-check"></i><b>12</b> ch. 14: Strings</a><ul>
<li class="chapter" data-level="12.1" data-path="ch-14-strings.html"><a href="ch-14-strings.html#string-basics"><i class="fa fa-check"></i><b>12.1</b> 14.2: String basics</a><ul>
<li class="chapter" data-level="12.1.1" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-40"><i class="fa fa-check"></i><b>12.1.1</b> 14.2.5</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ch-14-strings.html"><a href="ch-14-strings.html#matching-patterns-w-regex"><i class="fa fa-check"></i><b>12.2</b> 14.3: Matching patterns w/ regex</a><ul>
<li class="chapter" data-level="12.2.1" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-41"><i class="fa fa-check"></i><b>12.2.1</b> 14.3.1.1</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-42"><i class="fa fa-check"></i><b>12.2.2</b> 14.3.2.1</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-43"><i class="fa fa-check"></i><b>12.2.3</b> 14.3.3.1</a></li>
<li class="chapter" data-level="12.2.4" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-44"><i class="fa fa-check"></i><b>12.2.4</b> 14.3.4.1</a></li>
<li class="chapter" data-level="12.2.5" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-45"><i class="fa fa-check"></i><b>12.2.5</b> 14.3.5.1</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-14-strings.html"><a href="ch-14-strings.html#tools"><i class="fa fa-check"></i><b>12.3</b> 14.4 Tools</a><ul>
<li class="chapter" data-level="12.3.1" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-46"><i class="fa fa-check"></i><b>12.3.1</b> 14.4.2</a></li>
<li class="chapter" data-level="12.3.2" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-47"><i class="fa fa-check"></i><b>12.3.2</b> 14.4.3.1</a></li>
<li class="chapter" data-level="12.3.3" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-48"><i class="fa fa-check"></i><b>12.3.3</b> 14.4.4.1</a></li>
<li class="chapter" data-level="12.3.4" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-49"><i class="fa fa-check"></i><b>12.3.4</b> 14.4.5.1</a></li>
<li class="chapter" data-level="12.3.5" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-50"><i class="fa fa-check"></i><b>12.3.5</b> 14.4.6.1</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ch-14-strings.html"><a href="ch-14-strings.html#other-types-of-patterns"><i class="fa fa-check"></i><b>12.4</b> 14.5: Other types of patterns</a><ul>
<li class="chapter" data-level="12.4.1" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-51"><i class="fa fa-check"></i><b>12.4.1</b> 14.5.1</a></li>
<li class="chapter" data-level="12.4.2" data-path="ch-14-strings.html"><a href="ch-14-strings.html#section-52"><i class="fa fa-check"></i><b>12.4.2</b> 14.7.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-15-factors.html"><a href="ch-15-factors.html"><i class="fa fa-check"></i><b>13</b> ch. 15: Factors</a><ul>
<li class="chapter" data-level="13.1" data-path="ch-15-factors.html"><a href="ch-15-factors.html#modifying-factor-order"><i class="fa fa-check"></i><b>13.1</b> 15.4: Modifying factor order</a><ul>
<li class="chapter" data-level="13.1.1" data-path="ch-15-factors.html"><a href="ch-15-factors.html#section-53"><i class="fa fa-check"></i><b>13.1.1</b> 15.3.1</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-15-factors.html"><a href="ch-15-factors.html#modifying-factor-order-1"><i class="fa fa-check"></i><b>13.2</b> 15.4: Modifying factor order</a><ul>
<li class="chapter" data-level="13.2.1" data-path="ch-15-factors.html"><a href="ch-15-factors.html#section-54"><i class="fa fa-check"></i><b>13.2.1</b> 15.4.1</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-15-factors.html"><a href="ch-15-factors.html#modifying-factor-levels"><i class="fa fa-check"></i><b>13.3</b> 15.5: Modifying factor levels</a><ul>
<li class="chapter" data-level="13.3.1" data-path="ch-15-factors.html"><a href="ch-15-factors.html#section-55"><i class="fa fa-check"></i><b>13.3.1</b> 15.5.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-3.html"><a href="appendix-3.html"><i class="fa fa-check"></i><b>14</b> Appendix</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix-3.html"><a href="appendix-3.html#viewing-all-levels"><i class="fa fa-check"></i><b>14.1</b> Viewing all levels</a></li>
<li class="chapter" data-level="14.2" data-path="appendix-3.html"><a href="appendix-3.html#percentage-na-each-level"><i class="fa fa-check"></i><b>14.2</b> Percentage NA each level</a></li>
<li class="chapter" data-level="14.3" data-path="appendix-3.html"><a href="appendix-3.html#print-all-levels-of-tibble"><i class="fa fa-check"></i><b>14.3</b> Print all levels of tibble</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html"><i class="fa fa-check"></i><b>15</b> ch. 16: Dates and times</a><ul>
<li class="chapter" data-level="15.1" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#creating-datetimes"><i class="fa fa-check"></i><b>15.1</b> 16.2: Creating date/times</a><ul>
<li class="chapter" data-level="15.1.1" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#section-56"><i class="fa fa-check"></i><b>15.1.1</b> 16.2.4</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#date-time-components"><i class="fa fa-check"></i><b>15.2</b> 16.3: Date-time components</a><ul>
<li class="chapter" data-level="15.2.1" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#section-57"><i class="fa fa-check"></i><b>15.2.1</b> 16.3.4</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#time-spans"><i class="fa fa-check"></i><b>15.3</b> 16.4: Time spans</a><ul>
<li class="chapter" data-level="15.3.1" data-path="ch-16-dates-and-times.html"><a href="ch-16-dates-and-times.html#section-58"><i class="fa fa-check"></i><b>15.3.1</b> 16.4.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-4.html"><a href="appendix-4.html"><i class="fa fa-check"></i><b>16</b> Appendix</a><ul>
<li class="chapter" data-level="16.1" data-path="appendix-4.html"><a href="appendix-4.html#section-59"><i class="fa fa-check"></i><b>16.1</b> 16.3.4.1</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-4.html"><a href="appendix-4.html#section-60"><i class="fa fa-check"></i><b>16.2</b> 16.3.4.3</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-4.html"><a href="appendix-4.html#section-61"><i class="fa fa-check"></i><b>16.3</b> 16.3.4.4</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-18-pipes-notes-only.html"><a href="ch-18-pipes-notes-only.html"><i class="fa fa-check"></i><b>17</b> ch. 18: Pipes (notes only)</a></li>
<li class="chapter" data-level="18" data-path="ch-19-functions.html"><a href="ch-19-functions.html"><i class="fa fa-check"></i><b>18</b> ch. 19: Functions</a><ul>
<li class="chapter" data-level="18.1" data-path="ch-19-functions.html"><a href="ch-19-functions.html#when-should-you-write-a-function"><i class="fa fa-check"></i><b>18.1</b> 19.2: When should you write a function?</a><ul>
<li class="chapter" data-level="18.1.1" data-path="ch-19-functions.html"><a href="ch-19-functions.html#section-62"><i class="fa fa-check"></i><b>18.1.1</b> 19.2.1</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="ch-19-functions.html"><a href="ch-19-functions.html#functions-are-for-humans-and-computers"><i class="fa fa-check"></i><b>18.2</b> 19.3: Functions are for humans and computers</a><ul>
<li class="chapter" data-level="18.2.1" data-path="ch-19-functions.html"><a href="ch-19-functions.html#section-63"><i class="fa fa-check"></i><b>18.2.1</b> 19.3.1</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="ch-19-functions.html"><a href="ch-19-functions.html#conditional-execution"><i class="fa fa-check"></i><b>18.3</b> 19.4: Conditional execution</a><ul>
<li class="chapter" data-level="18.3.1" data-path="ch-19-functions.html"><a href="ch-19-functions.html#section-64"><i class="fa fa-check"></i><b>18.3.1</b> 19.4.4</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="ch-19-functions.html"><a href="ch-19-functions.html#function-arguments"><i class="fa fa-check"></i><b>18.4</b> 19.5: Function arguments</a><ul>
<li class="chapter" data-level="18.4.1" data-path="ch-19-functions.html"><a href="ch-19-functions.html#section-65"><i class="fa fa-check"></i><b>18.4.1</b> 19.5.5</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="ch-19-functions.html"><a href="ch-19-functions.html#return-values"><i class="fa fa-check"></i><b>18.5</b> 19.6: Return values</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="appendix-5.html"><a href="appendix-5.html"><i class="fa fa-check"></i><b>19</b> Appendix</a><ul>
<li class="chapter" data-level="19.1" data-path="appendix-5.html"><a href="appendix-5.html#section-66"><i class="fa fa-check"></i><b>19.1</b> 19.2.1.4</a></li>
<li class="chapter" data-level="19.2" data-path="appendix-5.html"><a href="appendix-5.html#changing-values-with-indexes"><i class="fa fa-check"></i><b>19.2</b> Changing values with indexes</a><ul>
<li class="chapter" data-level="19.2.1" data-path="appendix-5.html"><a href="appendix-5.html#applying-indexing-to-dfs"><i class="fa fa-check"></i><b>19.2.1</b> Applying indexing to dfs</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="appendix-5.html"><a href="appendix-5.html#better-than-ifelse"><i class="fa fa-check"></i><b>19.3</b> Better than <code>ifelse()</code>?</a></li>
<li class="chapter" data-level="19.4" data-path="appendix-5.html"><a href="appendix-5.html#dplyr-and-functions"><i class="fa fa-check"></i><b>19.4</b> Dplyr and functions</a></li>
<li class="chapter" data-level="19.5" data-path="appendix-5.html"><a href="appendix-5.html#section-67"><i class="fa fa-check"></i><b>19.5</b> 19.2.3.5</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html"><i class="fa fa-check"></i><b>20</b> ch. 20: Vectors</a><ul>
<li class="chapter" data-level="20.0.1" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#section-68"><i class="fa fa-check"></i><b>20.0.1</b> 20.3.5</a></li>
<li class="chapter" data-level="20.1" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#using-atomic-vectors"><i class="fa fa-check"></i><b>20.1</b> 20.4: Using atomic vectors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#section-69"><i class="fa fa-check"></i><b>20.1.1</b> 20.4.6</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#recursive-vectors-lists"><i class="fa fa-check"></i><b>20.2</b> 20.5: Recursive vectors (lists)</a><ul>
<li class="chapter" data-level="20.2.1" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#section-70"><i class="fa fa-check"></i><b>20.2.1</b> 20.5.4</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#augmented-vectors"><i class="fa fa-check"></i><b>20.3</b> 20.7: Augmented vectors</a><ul>
<li class="chapter" data-level="20.3.1" data-path="ch-20-vectors.html"><a href="ch-20-vectors.html#section-71"><i class="fa fa-check"></i><b>20.3.1</b> 20.7.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="appendix-6.html"><a href="appendix-6.html"><i class="fa fa-check"></i><b>21</b> Appendix</a><ul>
<li class="chapter" data-level="21.1" data-path="appendix-6.html"><a href="appendix-6.html#subsetting-nested-lists"><i class="fa fa-check"></i><b>21.1</b> subsetting nested lists</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html"><i class="fa fa-check"></i><b>22</b> ch. 21: Iteration</a><ul>
<li class="chapter" data-level="22.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#for-loops"><i class="fa fa-check"></i><b>22.1</b> 21.2: For loops</a><ul>
<li class="chapter" data-level="22.1.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#section-72"><i class="fa fa-check"></i><b>22.1.1</b> 21.2.1</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#for-loop-variations"><i class="fa fa-check"></i><b>22.2</b> 21.3 For loop variations</a><ul>
<li class="chapter" data-level="22.2.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#section-73"><i class="fa fa-check"></i><b>22.2.1</b> 21.3.5</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#for-loops-vs.-functionals"><i class="fa fa-check"></i><b>22.3</b> 21.4: For loops vs. functionals</a><ul>
<li class="chapter" data-level="22.3.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#section-74"><i class="fa fa-check"></i><b>22.3.1</b> 21.4.1</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#the-map-functions"><i class="fa fa-check"></i><b>22.4</b> 21.5: The map functions</a><ul>
<li class="chapter" data-level="22.4.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#section-75"><i class="fa fa-check"></i><b>22.4.1</b> 21.5.3</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#other-patterns-of-for-loops"><i class="fa fa-check"></i><b>22.5</b> 21.9 Other patterns of for loops</a><ul>
<li class="chapter" data-level="22.5.1" data-path="ch-21-iteration.html"><a href="ch-21-iteration.html#section-76"><i class="fa fa-check"></i><b>22.5.1</b> 21.9.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="appendix-7.html"><a href="appendix-7.html"><i class="fa fa-check"></i><b>23</b> Appendix</a><ul>
<li class="chapter" data-level="23.1" data-path="appendix-7.html"><a href="appendix-7.html#section-77"><i class="fa fa-check"></i><b>23.1</b> 21.3.5.1</a><ul>
<li class="chapter" data-level="23.1.1" data-path="appendix-7.html"><a href="appendix-7.html#using-map"><i class="fa fa-check"></i><b>23.1.1</b> Using map</a></li>
<li class="chapter" data-level="23.1.2" data-path="appendix-7.html"><a href="appendix-7.html#plot-of-names"><i class="fa fa-check"></i><b>23.1.2</b> Plot of names</a></li>
<li class="chapter" data-level="23.1.3" data-path="appendix-7.html"><a href="appendix-7.html#csv-other-example"><i class="fa fa-check"></i><b>23.1.3</b> csv other example</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="appendix-7.html"><a href="appendix-7.html#with-purrr"><i class="fa fa-check"></i><b>23.2</b> 21.3.5.2 with purrr</a></li>
<li class="chapter" data-level="23.3" data-path="appendix-7.html"><a href="appendix-7.html#mirroring-keep"><i class="fa fa-check"></i><b>23.3</b> 21.9 mirroring keep</a></li>
<li class="chapter" data-level="23.4" data-path="appendix-7.html"><a href="appendix-7.html#invoke-examples"><i class="fa fa-check"></i><b>23.4</b> invoke examples</a></li>
<li class="chapter" data-level="23.5" data-path="appendix-7.html"><a href="appendix-7.html#indexing-nms-caution"><i class="fa fa-check"></i><b>23.5</b> indexing nms caution</a></li>
<li class="chapter" data-level="23.6" data-path="appendix-7.html"><a href="appendix-7.html#in-class-notes"><i class="fa fa-check"></i><b>23.6</b> in class notes</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html"><i class="fa fa-check"></i><b>24</b> ch. 23: Model basics</a><ul>
<li class="chapter" data-level="24.1" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#a-simple-model"><i class="fa fa-check"></i><b>24.1</b> 23.2: A simple model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#section-78"><i class="fa fa-check"></i><b>24.1.1</b> 23.2.1</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#visualising-models"><i class="fa fa-check"></i><b>24.2</b> 23.3: Visualising models</a><ul>
<li class="chapter" data-level="24.2.1" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#section-79"><i class="fa fa-check"></i><b>24.2.1</b> 23.3.3</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#formulas-and-model-families"><i class="fa fa-check"></i><b>24.3</b> 23.4: Formulas and model families</a><ul>
<li class="chapter" data-level="24.3.1" data-path="ch-23-model-basics.html"><a href="ch-23-model-basics.html#section-80"><i class="fa fa-check"></i><b>24.3.1</b> 23.4.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="appendix-8.html"><a href="appendix-8.html"><i class="fa fa-check"></i><b>25</b> Appendix</a><ul>
<li class="chapter" data-level="25.1" data-path="appendix-8.html"><a href="appendix-8.html#other-model-families"><i class="fa fa-check"></i><b>25.1</b> Other model families</a></li>
<li class="chapter" data-level="25.2" data-path="appendix-8.html"><a href="appendix-8.html#book-example"><i class="fa fa-check"></i><b>25.2</b> 23.2 book example</a><ul>
<li class="chapter" data-level="25.2.1" data-path="appendix-8.html"><a href="appendix-8.html#tidy-grid_space"><i class="fa fa-check"></i><b>25.2.1</b> tidy grid_space</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="appendix-8.html"><a href="appendix-8.html#section-81"><i class="fa fa-check"></i><b>25.3</b> 23.4.5.4</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ch-24-model-building.html"><a href="ch-24-model-building.html"><i class="fa fa-check"></i><b>26</b> ch. 24: Model building</a><ul>
<li class="chapter" data-level="26.1" data-path="ch-24-model-building.html"><a href="ch-24-model-building.html#why-are-low-quality-diamonds-more-expensive"><i class="fa fa-check"></i><b>26.1</b> 24.2: Why are low quality diamonds more expensive?</a><ul>
<li class="chapter" data-level="26.1.1" data-path="ch-24-model-building.html"><a href="ch-24-model-building.html#section-82"><i class="fa fa-check"></i><b>26.1.1</b> 24.2.3</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="ch-24-model-building.html"><a href="ch-24-model-building.html#what-affects-the-number-of-daily-flights"><i class="fa fa-check"></i><b>26.2</b> 24.3 What affects the number of daily flights?</a><ul>
<li class="chapter" data-level="26.2.1" data-path="ch-24-model-building.html"><a href="ch-24-model-building.html#section-83"><i class="fa fa-check"></i><b>26.2.1</b> 24.3.5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="appendix-9.html"><a href="appendix-9.html"><i class="fa fa-check"></i><b>27</b> Appendix</a><ul>
<li class="chapter" data-level="27.1" data-path="appendix-9.html"><a href="appendix-9.html#section-84"><i class="fa fa-check"></i><b>27.1</b> 24.2.3.3</a></li>
<li class="chapter" data-level="27.2" data-path="appendix-9.html"><a href="appendix-9.html#section-85"><i class="fa fa-check"></i><b>27.2</b> 24.2.3.4</a><ul>
<li class="chapter" data-level="27.2.1" data-path="appendix-9.html"><a href="appendix-9.html#heteroskedasticity"><i class="fa fa-check"></i><b>27.2.1</b> heteroskedasticity</a></li>
<li class="chapter" data-level="27.2.2" data-path="appendix-9.html"><a href="appendix-9.html#rsquared-on-logged-values"><i class="fa fa-check"></i><b>27.2.2</b> rsquared on logged values</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="appendix-9.html"><a href="appendix-9.html#section-86"><i class="fa fa-check"></i><b>27.3</b> 24.2.3.1</a><ul>
<li class="chapter" data-level="27.3.1" data-path="appendix-9.html"><a href="appendix-9.html#more-notes-on-logs"><i class="fa fa-check"></i><b>27.3.1</b> More notes on logs</a></li>
<li class="chapter" data-level="27.3.2" data-path="appendix-9.html"><a href="appendix-9.html#carat-more-clumped-than-price"><i class="fa fa-check"></i><b>27.3.2</b> carat more clumped than price</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="appendix-9.html"><a href="appendix-9.html#logs-simulated-examples"><i class="fa fa-check"></i><b>27.4</b> Logs (simulated examples)</a><ul>
<li class="chapter" data-level="27.4.1" data-path="appendix-9.html"><a href="appendix-9.html#exponential-relationship"><i class="fa fa-check"></i><b>27.4.1</b> Exponential relationship</a></li>
<li class="chapter" data-level="27.4.2" data-path="appendix-9.html"><a href="appendix-9.html#log-log-relationship"><i class="fa fa-check"></i><b>27.4.2</b> Log log relationship</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="appendix-9.html"><a href="appendix-9.html#diamonds-data-review"><i class="fa fa-check"></i><b>27.5</b> Diamonds data review</a><ul>
<li class="chapter" data-level="27.5.1" data-path="appendix-9.html"><a href="appendix-9.html#carat-by-mean-table-value"><i class="fa fa-check"></i><b>27.5.1</b> carat by mean <code>table</code> value</a></li>
<li class="chapter" data-level="27.5.2" data-path="appendix-9.html"><a href="appendix-9.html#cutoff-part-1"><i class="fa fa-check"></i><b>27.5.2</b> Cutoff, Part 1</a></li>
<li class="chapter" data-level="27.5.3" data-path="appendix-9.html"><a href="appendix-9.html#cutoff-part-2"><i class="fa fa-check"></i><b>27.5.3</b> Cutoff, Part 2</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="appendix-9.html"><a href="appendix-9.html#section-87"><i class="fa fa-check"></i><b>27.6</b> 25.3.5.4</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html"><i class="fa fa-check"></i><b>28</b> ch. 25: Many models</a><ul>
<li class="chapter" data-level="28.1" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#gapminder"><i class="fa fa-check"></i><b>28.1</b> 25.2: gapminder</a><ul>
<li class="chapter" data-level="28.1.1" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#section-88"><i class="fa fa-check"></i><b>28.1.1</b> 25.2.5</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#creating-list-columns"><i class="fa fa-check"></i><b>28.2</b> 25.4: Creating list-columns</a><ul>
<li class="chapter" data-level="28.2.1" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#section-89"><i class="fa fa-check"></i><b>28.2.1</b> 25.4.5</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#simplifying-list-columns"><i class="fa fa-check"></i><b>28.3</b> 25.5: Simplifying list-columns</a><ul>
<li class="chapter" data-level="28.3.1" data-path="ch-25-many-models.html"><a href="ch-25-many-models.html#section-90"><i class="fa fa-check"></i><b>28.3.1</b> 25.5.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="appendix-10.html"><a href="appendix-10.html"><i class="fa fa-check"></i><b>29</b> Appendix</a><ul>
<li class="chapter" data-level="29.1" data-path="appendix-10.html"><a href="appendix-10.html#models-in-lists"><i class="fa fa-check"></i><b>29.1</b> models in lists</a></li>
<li class="chapter" data-level="29.2" data-path="appendix-10.html"><a href="appendix-10.html#list-columns-for-sampling"><i class="fa fa-check"></i><b>29.2</b> list-columns for sampling</a></li>
<li class="chapter" data-level="29.3" data-path="appendix-10.html"><a href="appendix-10.html#section-91"><i class="fa fa-check"></i><b>29.3</b> 25.2.5.1</a><ul>
<li class="chapter" data-level="29.3.1" data-path="appendix-10.html"><a href="appendix-10.html#include-cubic-term"><i class="fa fa-check"></i><b>29.3.1</b> Include cubic term</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="appendix-10.html"><a href="appendix-10.html#multiple-graphs-in-chunk"><i class="fa fa-check"></i><b>29.4</b> Multiple graphs in chunk</a></li>
<li class="chapter" data-level="29.5" data-path="appendix-10.html"><a href="appendix-10.html#listquantile-examples"><i class="fa fa-check"></i><b>29.5</b> list(quantile()) examples</a></li>
<li class="chapter" data-level="29.6" data-path="appendix-10.html"><a href="appendix-10.html#extracting-row-names"><i class="fa fa-check"></i><b>29.6</b> extracting row names</a></li>
<li class="chapter" data-level="29.7" data-path="appendix-10.html"><a href="appendix-10.html#invoke_map-example-book"><i class="fa fa-check"></i><b>29.7</b> <code>invoke_map</code> example (book)</a></li>
<li class="chapter" data-level="29.8" data-path="appendix-10.html"><a href="appendix-10.html#named-list-example-book"><i class="fa fa-check"></i><b>29.8</b> named list example (book)</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html"><i class="fa fa-check"></i><b>30</b> ch. 27: R Markdown</a><ul>
<li class="chapter" data-level="30.1" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#r-markdown-basics"><i class="fa fa-check"></i><b>30.1</b> 27.2 R Markdown basics</a><ul>
<li class="chapter" data-level="30.1.1" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#section-92"><i class="fa fa-check"></i><b>30.1.1</b> 27.2.1</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#text-formatting-with-markdown"><i class="fa fa-check"></i><b>30.2</b> 27.3: Text formatting with Markdown</a><ul>
<li class="chapter" data-level="30.2.1" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#section-93"><i class="fa fa-check"></i><b>30.2.1</b> 27.3.1</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#cv-of-bryan-shalloway"><i class="fa fa-check"></i><b>30.3</b> <strong>CV of Bryan Shalloway</strong></a></li>
<li class="chapter" data-level="30.4" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#experience"><i class="fa fa-check"></i><b>30.4</b> Experience</a></li>
<li class="chapter" data-level="30.5" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#education"><i class="fa fa-check"></i><b>30.5</b> Education</a></li>
<li class="chapter" data-level="30.6" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>30.6</b> 27.4: Code chunks</a><ul>
<li class="chapter" data-level="30.6.1" data-path="ch-27-r-markdown.html"><a href="ch-27-r-markdown.html#section-94"><i class="fa fa-check"></i><b>30.6.1</b> 27.4.7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html"><i class="fa fa-check"></i><b>31</b> ch. 28: Graphics for communication</a><ul>
<li class="chapter" data-level="31.1" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#label"><i class="fa fa-check"></i><b>31.1</b> 28.2: Label</a><ul>
<li class="chapter" data-level="31.1.1" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#section-95"><i class="fa fa-check"></i><b>31.1.1</b> 28.2.1</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#annotations"><i class="fa fa-check"></i><b>31.2</b> 28.3: Annotations</a><ul>
<li class="chapter" data-level="31.2.1" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#section-96"><i class="fa fa-check"></i><b>31.2.1</b> 28.3.1</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#scales"><i class="fa fa-check"></i><b>31.3</b> 28.4: Scales</a><ul>
<li class="chapter" data-level="31.3.1" data-path="ch-28-graphics-for-communication.html"><a href="ch-28-graphics-for-communication.html#section-97"><i class="fa fa-check"></i><b>31.3.1</b> 28.4.4</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Another set of solutions to ‘R for Data Science’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix-1" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Appendix</h1>
<p>The appendix is either extensions upon solutions. Solving the problems using functions we haven’te learned yet, or other random notes / tidbits.</p>
<div id="section-11" class="section level2">
<h2><span class="header-section-number">5.1</span> 5.4.1.3.</h2>
<p>You actually don’t need <code>one_of</code> for selecting by character vector, more useful is when using it to negate fields by name.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">select</span>(flights, <span class="op">-</span><span class="kw">one_of</span>(vars))</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 15
##     year month   day sched_dep_time sched_arr_time carrier flight tailnum
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;          &lt;int&gt;          &lt;int&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;  
##  1  2013     1     1            515            819 UA        1545 N14228 
##  2  2013     1     1            529            830 UA        1714 N24211 
##  3  2013     1     1            540            850 AA        1141 N619AA 
##  4  2013     1     1            545           1022 B6         725 N804JB 
##  5  2013     1     1            600            837 DL         461 N668DN 
##  6  2013     1     1            558            728 UA        1696 N39463 
##  7  2013     1     1            600            854 B6         507 N516JB 
##  8  2013     1     1            600            723 EV        5708 N829AS 
##  9  2013     1     1            600            846 B6          79 N593JB 
## 10  2013     1     1            600            745 AA         301 N3ALAA 
## # ... with 336,766 more rows, and 7 more variables: origin &lt;chr&gt;,
## #   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
## #   time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="section-12" class="section level2">
<h2><span class="header-section-number">5.2</span> 5.5.2.1.</h2>
<p>Other, more sophisticated method<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="kw">mutate_at</span>(<span class="dt">.tbl =</span> flights, </a>
<a class="sourceLine" id="cb236-2" title="2">          <span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;sched_dep_time&quot;</span>), </a>
<a class="sourceLine" id="cb236-3" title="3">          <span class="dt">.funs =</span> <span class="kw">funs</span>(<span class="dt">new =</span> time_to_mins)) </a></code></pre></div>
</div>
<div id="section-13" class="section level2">
<h2><span class="header-section-number">5.3</span> 5.5.2.2</h2>
<div id="closer-look-at-air_time" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Closer look at <code>air_time</code></h3>
<p>Wanted to look at original <code>air_time</code> variable a little more. Histogram below shows that most differences are now between 20 - 40 minutes from the actual time.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb237-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb237-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">distance_med =</span> <span class="kw">median</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb237-4" title="4">            <span class="dt">air_calc_med =</span> <span class="kw">median</span>(air_calc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb237-5" title="5">            <span class="dt">air_old_med =</span> <span class="kw">median</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb237-6" title="6">            <span class="dt">diff_new_old =</span> air_calc_med <span class="op">-</span><span class="st"> </span>air_old_med,</a>
<a class="sourceLine" id="cb237-7" title="7">            <span class="dt">diff_hrs =</span> <span class="kw">as.factor</span>(<span class="kw">round</span>(diff_new_old<span class="op">/</span><span class="dv">60</span>)),</a>
<a class="sourceLine" id="cb237-8" title="8">            <span class="dt">num =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb237-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(diff_new_old))<span class="op">+</span></a>
<a class="sourceLine" id="cb237-10" title="10"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 5 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Regressing <code>diff</code> on <code>arr_delay</code> and <code>dep_delay</code> (remember <code>diff</code> is the difference between <code>air_time</code> and <code>air_calc</code>)</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1">mod_air_time2 &lt;-<span class="st"> </span><span class="kw">mutate</span>(flights_new2, <span class="dt">diff =</span>  (air_time <span class="op">-</span><span class="st"> </span>air_calc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>air_time, <span class="op">-</span>air_calc, <span class="op">-</span>flight, <span class="op">-</span>tailnum, <span class="op">-</span>dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-3" title="3"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-4" title="4"><span class="st">  </span><span class="kw">lm</span>(diff <span class="op">~</span><span class="st"> </span>dep_delay <span class="op">+</span><span class="st"> </span>arr_delay, <span class="dt">data =</span> .)</a>
<a class="sourceLine" id="cb240-5" title="5"></a>
<a class="sourceLine" id="cb240-6" title="6"><span class="kw">summary</span>(mod_air_time2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff ~ dep_delay + arr_delay, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -93.168  -6.684   0.688   6.878 101.169 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -33.511843   0.024118 -1389.5   &lt;2e-16 ***
## dep_delay     0.533376   0.001355   393.5   &lt;2e-16 ***
## arr_delay    -0.552852   0.001217  -454.2   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.43 on 319806 degrees of freedom
## Multiple R-squared:  0.3956, Adjusted R-squared:  0.3956 
## F-statistic: 1.047e+05 on 2 and 319806 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Doing such accounts for ~40% of the variation in the values.</p>
<p>The <code>dep_delay</code> and <code>arr_delay</code> variables are highly colinear which is part of the reason for the coefficients being opposite in the model.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-2" title="2"><span class="st">  </span><span class="kw">select</span>(air_time, air_calc, arr_delay, dep_delay) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> air_time <span class="op">-</span><span class="st"> </span>air_calc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>air_time, <span class="op">-</span>air_calc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-5" title="5"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-6" title="6"><span class="st">  </span><span class="kw">cor</span>()</a></code></pre></div>
<pre><code>##            arr_delay   dep_delay        diff
## arr_delay  1.0000000  0.91531953 -0.32086698
## dep_delay  0.9153195  1.00000000 -0.07582942
## diff      -0.3208670 -0.07582942  1.00000000</code></pre>
<p>Typically, this suggests that you do not need to include both variables in the model as they will likely be providing the same information. Though here that is not the case as only including <code>arr_delay</code> associates with a steep decline in <code>R^2</code> to just account for ~10% of the variation.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1">mod_air_time &lt;-<span class="st"> </span><span class="kw">mutate</span>(flights_new2, <span class="dt">diff =</span>  (air_time <span class="op">-</span><span class="st"> </span>air_calc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>air_time, <span class="op">-</span>air_calc, <span class="op">-</span>flight, <span class="op">-</span>tailnum, <span class="op">-</span>dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-3" title="3"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-4" title="4"><span class="kw">lm</span>(diff <span class="op">~</span><span class="st"> </span>arr_delay, <span class="dt">data =</span> .)</a>
<a class="sourceLine" id="cb244-5" title="5"></a>
<a class="sourceLine" id="cb244-6" title="6"><span class="kw">summary</span>(mod_air_time)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = diff ~ arr_delay, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -182.960   -6.385    2.013    7.983  154.382 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -2.984e+01  2.710e-02 -1101.3   &lt;2e-16 ***
## arr_delay   -1.144e-01  5.972e-04  -191.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.14 on 319807 degrees of freedom
## Multiple R-squared:  0.103,  Adjusted R-squared:  0.103 
## F-statistic: 3.67e+04 on 1 and 319807 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Add predictions from models of <code>air_time</code> to dataframe and take sample of 500 from entire <code>flights</code> dataset to visualise.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">flights_preds_mod &lt;-<span class="st"> </span>flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb246-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span>  (air_time <span class="op">-</span><span class="st"> </span>air_calc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb246-3" title="3"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb246-4" title="4"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">spread_predictions</span>(mod_air_time, mod_air_time2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb246-5" title="5"><span class="st">  </span><span class="kw">select</span>(diff, dep_delay, arr_delay, air_calc, air_time, mod_air_time, mod_air_time2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb246-6" title="6"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">500</span>) </a></code></pre></div>
<p>Looking at <code>dep_delay</code> on <code>arr_delay</code> with <code>diff</code> overlaid in colour.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1">flights_preds_mod <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb247-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff_group =</span> <span class="kw">cut</span>(diff, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb247-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dep_delay, arr_delay))<span class="op">+</span></a>
<a class="sourceLine" id="cb247-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> diff_group))</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>I’m going to stop there though for now. Below are just some other plots I was messing aroun with.</p>
</div>
<div id="other-plots-with-air_time" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Other plots with <code>air_time</code></h3>
<p>These are mostly just me messing around. This section will be very tough to follow.</p>
<p>Produce 3-d plot with actuals in black and predictions in red and green (not evaluated in html document).</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1">a &lt;-<span class="st"> </span>flights_preds_mod<span class="op">$</span>arr_delay</a>
<a class="sourceLine" id="cb248-2" title="2">b &lt;-<span class="st"> </span>flights_preds_mod<span class="op">$</span>dep_delay</a>
<a class="sourceLine" id="cb248-3" title="3">c &lt;-<span class="st"> </span>flights_preds_mod<span class="op">$</span>diff</a>
<a class="sourceLine" id="cb248-4" title="4">rgl<span class="op">::</span><span class="kw">plot3d</span>(a, b, c)</a>
<a class="sourceLine" id="cb248-5" title="5"></a>
<a class="sourceLine" id="cb248-6" title="6"><span class="co">#one variabled model</span></a>
<a class="sourceLine" id="cb248-7" title="7">rgl<span class="op">::</span><span class="kw">points3d</span>(a, <span class="dv">0</span>, flights_preds_mod<span class="op">$</span>mod_air_time, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb248-8" title="8"></a>
<a class="sourceLine" id="cb248-9" title="9"><span class="co">#two variabled model</span></a>
<a class="sourceLine" id="cb248-10" title="10">rgl<span class="op">::</span><span class="kw">points3d</span>(a, b, flights_preds_mod<span class="op">$</span>mod_air_time2, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p>Plot of median <code>air_time</code> vs. median <code>dist</code>.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb249-2" title="2"><span class="st">  </span><span class="kw">select</span>(dest, dep_time, arr_time, air_time, distance) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb249-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb249-4" title="4">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb249-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb249-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">med_air =</span> <span class="kw">median</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb249-7" title="7">            <span class="dt">med_dist =</span> <span class="kw">median</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb249-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> med_dist, <span class="dt">y =</span> med_air))<span class="op">+</span></a>
<a class="sourceLine" id="cb249-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb249-10" title="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">660</span>, <span class="dv">60</span>))</a></code></pre></div>
<pre><code>## Warning: funs() is soft deprecated as of dplyr 0.8.0
## please use list() instead
## 
## # Before:
## funs(name = f(.)
## 
## # After: 
## list(name = ~f(.))
## This warning is displayed once per session.</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Use linear regression to identify those points that were off from the relationship between <code>air_time</code> and <code>distance</code>.
+First build model
+Add residuals onto dataframe
+Arrange df so that largest residuals are at the top.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">time_dist_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(air_time <span class="op">~</span><span class="st"> </span>distance, <span class="dt">data =</span> flights)</a>
<a class="sourceLine" id="cb252-2" title="2"></a>
<a class="sourceLine" id="cb252-3" title="3">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-4" title="4"><span class="st">  </span><span class="kw">select</span>(dest, dep_time, arr_time, air_time, distance) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-5" title="5"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb252-6" title="6">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-7" title="7"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-8" title="8"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">air_time =</span> <span class="kw">median</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb252-9" title="9">            <span class="dt">distance =</span> <span class="kw">median</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-10" title="10"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">add_predictions</span>(time_dist_mod) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-11" title="11"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">add_residuals</span>(time_dist_mod) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-12" title="12"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="kw">abs</span>(resid)))</a></code></pre></div>
<pre><code>## # A tibble: 105 x 5
##    dest  air_time distance  pred resid
##    &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 ANC       414.     3370 443.  -29.0
##  2 HNL       616      4963 644.  -28.4
##  3 BQN       194      1576 217.  -23.2
##  4 SJU       197      1598 220.  -23.0
##  5 PSE       201      1617 222.  -21.4
##  6 STT       203      1623 223.  -20.2
##  7 EGE       253      1726 236.   16.9
##  8 BGR        54       378  66.1 -12.1
##  9 PSP       330.     2378 318.   12.1
## 10 HDN       247      1728 236.   10.6
## # ... with 95 more rows</code></pre>
<p>Looks like BQN, SJU, PSE, and STT are the closer of dests with the greatest departures (in addition to the higher leverage points ANC and HNL). (note the columns here are median values despite the ‘med’ not being in the column names)</p>
<p>Let’s do the samthing as above but just plot this output in a gpplot with our preds representing the line from our model.
(are using our own specified model rather than just using <code>geom_smooth</code>.)</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-2" title="2"><span class="st">  </span><span class="kw">select</span>(dest, dep_time, arr_time, air_time, distance) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb254-4" title="4">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">air_time =</span> <span class="kw">median</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb254-7" title="7">            <span class="dt">distance =</span> <span class="kw">median</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-8" title="8"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">add_predictions</span>(time_dist_mod) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-9" title="9"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">add_residuals</span>(time_dist_mod) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-10" title="10"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="kw">abs</span>(resid))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb254-11" title="11"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> distance, <span class="dt">y =</span> air_time))<span class="op">+</span></a>
<a class="sourceLine" id="cb254-12" title="12"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred), <span class="dt">colour =</span> <span class="st">&quot;navy blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb254-13" title="13"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb254-14" title="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">660</span>, <span class="dv">60</span>))</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>For fun, select 6 random <code>dest</code> and plot the <code>dep_time</code> vs <code>air_calc</code> (true <code>air_time</code>) with a median line cutting through the ponits.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb256-2" title="2">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb256-4" title="4">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">med_calc =</span> <span class="kw">median</span>(air_calc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-7" title="7"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-8" title="8"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-9" title="9"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb256-10" title="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dep_time, <span class="dt">y =</span> air_calc))<span class="op">+</span></a>
<a class="sourceLine" id="cb256-11" title="11"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb256-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> med_calc))<span class="op">+</span></a>
<a class="sourceLine" id="cb256-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">60</span>, <span class="dv">120</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb256-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>dest)</a></code></pre></div>
<pre><code>## Warning: Removed 604 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 101 rows containing missing values (geom_path).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Do the same with the original <code>air_calc</code> values (would want to standardize access between these and above)</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb259-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-3" title="3"><span class="st">  </span><span class="co"># select(dest, dep_time, arr_time, air_time, distance) %&gt;% </span></a>
<a class="sourceLine" id="cb259-4" title="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb259-5" title="5">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">med_AirTime =</span> <span class="kw">median</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-8" title="8"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-9" title="9"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-10" title="10"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb259-11" title="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dep_time, <span class="dt">y =</span> air_time))<span class="op">+</span></a>
<a class="sourceLine" id="cb259-12" title="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb259-13" title="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> med_AirTime))<span class="op">+</span></a>
<a class="sourceLine" id="cb259-14" title="14"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">60</span>, <span class="dv">120</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb259-15" title="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>dest)</a></code></pre></div>
<pre><code>## Warning: Removed 289 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 101 rows containing missing values (geom_path).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Explore the <code>air_time</code> var more.
If you want to see how these may differ by different categories<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.</p>
<p>Select 6 random <code>dest</code>s and plot all points for <code>distance</code> and <code>air_time</code></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-2" title="2"><span class="st">  </span><span class="kw">select</span>(dest, dep_time, arr_time, air_time, distance) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb262-4" title="4">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-6" title="6"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-7" title="7"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-8" title="8"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> distance, <span class="dt">y =</span> air_time))<span class="op">+</span></a>
<a class="sourceLine" id="cb262-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> dest))</a></code></pre></div>
<pre><code>## Warning: Removed 341 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>Distribution of times each flight number runs in window.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb264-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(flight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb264-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb264-4" title="4"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb264-5" title="5"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&lt;</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb264-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n))<span class="op">+</span></a>
<a class="sourceLine" id="cb264-7" title="7"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
</div>
</div>
<div id="section-14" class="section level2">
<h2><span class="header-section-number">5.4</span> 5.6.7.1.</h2>
<p>Below is an extension on using the <code>quantile</code> method, but it is far beyond where we are right now.</p>
<p>For the question <em>90th percentile for delays for flights by destination</em> we used <code>quantile</code> to output only the 90th percentile of values for each destination. Here, I want to address what if you had wanted to output the delays at multiple values, say, arbitrarily the 25th, 50th, 75th percentiles. One option would be to create a new variable for each value and in each quantile function sepcify 0.25, 0.50, 0.75 respectively.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">delay.25 =</span> <span class="kw">quantile</span>(arr_delay, <span class="fl">0.25</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb265-4" title="4">            <span class="dt">delay.50 =</span> <span class="kw">quantile</span>(arr_delay, <span class="fl">0.50</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb265-5" title="5">            <span class="dt">delay.75 =</span> <span class="kw">quantile</span>(arr_delay, <span class="fl">0.75</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## # A tibble: 105 x 4
##    dest  delay.25 delay.50 delay.75
##    &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 ABQ      -24       -5.5     22.8
##  2 ACK      -13       -3       10  
##  3 ALB      -17       -4       28  
##  4 ANC      -10.8      1.5     10  
##  5 ATL      -12       -1       16  
##  6 AUS      -19       -5       15  
##  7 AVL      -11       -1       13  
##  8 BDL      -18      -10       14  
##  9 BGR      -21.8     -9       19.8
## 10 BHM      -20       -2       34  
## # ... with 95 more rows</code></pre>
<p>But there is a lot of replication here and the <code>quantile</code> function is also able to output more than one value by specifying the <code>probs</code> argument.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">quantile</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>), <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">.50</span>, <span class="fl">0.75</span>))</a></code></pre></div>
<pre><code>##   25%   50%   75% 
## 25.75 50.50 75.25</code></pre>
<p>So, in theory, rather than calling <code>quantile</code> multiple times, you could just call it once. However for any variable you create <code>summarise</code> is expecting only a single value output for each row, so just passing it in as-is will cause it to fail.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb269-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb269-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">delays =</span> <span class="kw">quantile</span>(arr_delay, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">.50</span>, <span class="fl">0.75</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## Error: Column `delays` must be length 1 (a summary value), not 3</code></pre>
<p>To make this work you need to make the value a list, so that it will output a single list in each row of the column<sup>[This style is covered at the end of the book in the section ‘list-columns’ in iteration.]</sup>[Also you need your dataframe to be in a tibble form rather than traditional dataframes for list-cols to work]. I am going to create another list-column field of the quantiles I specified.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">prob_vals &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.25</span>, <span class="dt">to =</span> <span class="fl">0.75</span>, <span class="dt">by =</span> <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb271-2" title="2"></a>
<a class="sourceLine" id="cb271-3" title="3">flights_quantiles &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">delays_val =</span> <span class="kw">list</span>(<span class="kw">quantile</span>(arr_delay, <span class="dt">probs =</span> prob_vals, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb271-6" title="6">            <span class="dt">delays_q =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&#39;25th&#39;</span>, <span class="st">&#39;50th&#39;</span>, <span class="st">&#39;75th&#39;</span>)))</a>
<a class="sourceLine" id="cb271-7" title="7"></a>
<a class="sourceLine" id="cb271-8" title="8">flights_quantiles</a></code></pre></div>
<pre><code>## # A tibble: 105 x 3
##    dest  delays_val delays_q 
##    &lt;chr&gt; &lt;list&gt;     &lt;list&gt;   
##  1 ABQ   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  2 ACK   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  3 ALB   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  4 ANC   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  5 ATL   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  6 AUS   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  7 AVL   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  8 BDL   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
##  9 BGR   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
## 10 BHM   &lt;dbl [3]&gt;  &lt;chr [3]&gt;
## # ... with 95 more rows</code></pre>
<p>To convert these outputs out of the list-col format, I can use the function <code>unnest</code>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">flights_quantiles <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb273-2" title="2"><span class="st">  </span><span class="kw">unnest</span>()</a></code></pre></div>
<pre><code>## # A tibble: 315 x 3
##    dest  delays_val delays_q
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;   
##  1 ABQ        -24   25th    
##  2 ABQ         -5.5 50th    
##  3 ABQ         22.8 75th    
##  4 ACK        -13   25th    
##  5 ACK         -3   50th    
##  6 ACK         10   75th    
##  7 ALB        -17   25th    
##  8 ALB         -4   50th    
##  9 ALB         28   75th    
## 10 ANC        -10.8 25th    
## # ... with 305 more rows</code></pre>
<p>This will output the values as individual rows, repeating the <code>dest</code> value for the length of the list. If I want to spread the <code>delays_quantile</code> values into seperate columns I can use the <code>spread</code> function that is in the tidying R chapter.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1">flights_quantiles <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-2" title="2"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-3" title="3"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> delays_q, <span class="dt">value =</span> delays_val, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 105 x 4
##    dest  delays_q_25th delays_q_50th delays_q_75th
##    &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 ABQ           -24            -5.5          22.8
##  2 ACK           -13            -3            10  
##  3 ALB           -17            -4            28  
##  4 ANC           -10.8           1.5          10  
##  5 ATL           -12            -1            16  
##  6 AUS           -19            -5            15  
##  7 AVL           -11            -1            13  
##  8 BDL           -18           -10            14  
##  9 BGR           -21.8          -9            19.8
## 10 BHM           -20            -2            34  
## # ... with 95 more rows</code></pre>
<p>Let’s plot our unnested (but not unspread) data to see roughly the distribution of the delays for each destination at our quantiles of interest<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1">flights_quantiles <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-3" title="3"><span class="st">  </span><span class="co"># mutate(delays_q = forcats::fct_reorder(f = delays_q, x = delays_val, fun = mean, na.rm = TRUE)) %&gt;%</span></a>
<a class="sourceLine" id="cb277-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> delays_q, <span class="dt">y =</span> delays_val))<span class="op">+</span></a>
<a class="sourceLine" id="cb277-5" title="5"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 3 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>It can be a hassle naming the values explicitly. <code>quantile</code>’s default <code>probs</code> argument value is 0, 0.25, 0.5, 0.75, 1. Rather than needing to type the <code>delays_q</code> values <code>list(c('0%', '25%', '50%', '75%', '100%'))</code> you could have generated the values of these names dynamically using the <code>map</code> function in the <code>purrr</code> package (see chapter on iteration) to pass the <code>names</code> function over each value in <code>delays_val</code>.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1">flights_quantiles2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">delays_val =</span> <span class="kw">list</span>(<span class="kw">quantile</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb279-4" title="4">            <span class="dt">delays_q =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&#39;0th&#39;</span>, <span class="st">&#39;25th&#39;</span>, <span class="st">&#39;50th&#39;</span>, <span class="st">&#39;75th&#39;</span>, <span class="st">&#39;100th&#39;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">delays_q2 =</span> purrr<span class="op">::</span><span class="kw">map</span>(delays_val, names))</a>
<a class="sourceLine" id="cb279-6" title="6"></a>
<a class="sourceLine" id="cb279-7" title="7">flights_quantiles2</a></code></pre></div>
<pre><code>## # A tibble: 105 x 4
##    dest  delays_val delays_q  delays_q2
##    &lt;chr&gt; &lt;list&gt;     &lt;list&gt;    &lt;list&gt;   
##  1 ABQ   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  2 ACK   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  3 ALB   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  4 ANC   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  5 ATL   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  6 AUS   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  7 AVL   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  8 BDL   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
##  9 BGR   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
## 10 BHM   &lt;dbl [5]&gt;  &lt;chr [5]&gt; &lt;chr [5]&gt;
## # ... with 95 more rows</code></pre>
<p>And then let’s <code>unnest</code> the data<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1">flights_quantiles2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb281-2" title="2"><span class="st">  </span><span class="kw">unnest</span>()</a></code></pre></div>
<pre><code>## # A tibble: 525 x 4
##    dest  delays_val delays_q delays_q2
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
##  1 ABQ        -61   0th      0%       
##  2 ABQ        -24   25th     25%      
##  3 ABQ         -5.5 50th     50%      
##  4 ABQ         22.8 75th     75%      
##  5 ABQ        153   100th    100%     
##  6 ACK        -25   0th      0%       
##  7 ACK        -13   25th     25%      
##  8 ACK         -3   50th     50%      
##  9 ACK         10   75th     75%      
## 10 ACK        221   100th    100%     
## # ... with 515 more rows</code></pre>
</div>
<div id="section-15" class="section level2">
<h2><span class="header-section-number">5.5</span> 5.6.7.4.</h2>
<p>To measure the difference in speed you can use the <code>microbenchmark</code> function</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="dt">sub_optimal =</span> <span class="kw">filter</span>(flights, <span class="kw">is.na</span>(dep_delay) <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb283-2" title="2">                               <span class="dt">optimal =</span> <span class="kw">filter</span>(flights, <span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb283-3" title="3">                               <span class="dt">times =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## Unit: milliseconds
##         expr      min       lq     mean   median       uq       max neval
##  sub_optimal 4.837101 5.660301 7.055281 6.891951 7.830601 10.312501    10
##      optimal 3.363102 3.972701 4.787591 4.713501 5.686901  6.458901    10
##  cld
##    b
##   a</code></pre>
</div>
<div id="section-16" class="section level2">
<h2><span class="header-section-number">5.6</span> 5.6.7.5.</h2>
<p>Explore the percentage delayed vs. percentage cancelled.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb285-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb285-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb285-4" title="4">            <span class="dt">delayed =</span> <span class="kw">sum</span>(arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb285-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb285-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num,</a>
<a class="sourceLine" id="cb285-7" title="7">            <span class="dt">delayed_perc =</span> delayed <span class="op">/</span><span class="st"> </span>num) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb285-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> day))<span class="op">+</span></a>
<a class="sourceLine" id="cb285-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> cancelled_perc), <span class="dt">colour =</span> <span class="st">&quot;dark blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb285-10" title="10"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> delayed_perc), <span class="dt">colour =</span> <span class="st">&quot;dark red&quot;</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Let’s try faceting by origin and looking at both values next to each other.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb286-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb286-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb286-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb286-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb286-7" title="7"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> type, <span class="dt">value =</span> value, avg_delayed, cancelled_perc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb286-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> day, <span class="dt">y =</span> value))<span class="op">+</span></a>
<a class="sourceLine" id="cb286-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb286-10" title="10"><span class="st">  </span><span class="kw">facet_grid</span>(type <span class="op">~</span><span class="st"> </span>origin, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>Look’s like the relationship across origins with the delay overlaid with color (not actually crazy about how this look).</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb287-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb287-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb287-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb287-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb287-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb287-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> day, <span class="dt">y =</span> cancelled_perc, <span class="dt">colour =</span> avg_delayed))<span class="op">+</span></a>
<a class="sourceLine" id="cb287-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb287-9" title="9"><span class="st">  </span><span class="kw">facet_grid</span>(origin <span class="op">~</span><span class="st"> </span>.)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>Let’s look at values as individual points and overlay a <code>geom_smooth</code></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb288-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb288-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb288-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb288-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb288-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb288-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(avg_delayed, cancelled_perc, <span class="dt">colour =</span> origin))<span class="op">+</span></a>
<a class="sourceLine" id="cb288-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb288-9" title="9"><span class="st">  </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div id="modeling-approach" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Modeling approach</h3>
<p>We also could approach this using a model and regressing the average proportion of cancelled flights on average delay.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1">cancelled_mod1 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb290-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb290-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb290-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-7" title="7"><span class="st">  </span><span class="kw">lm</span>(cancelled_perc <span class="op">~</span><span class="st"> </span>avg_delayed, <span class="dt">data =</span> .)</a>
<a class="sourceLine" id="cb290-8" title="8"></a>
<a class="sourceLine" id="cb290-9" title="9"><span class="kw">summary</span>(cancelled_mod1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = cancelled_perc ~ avg_delayed, data = .)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.026363 -0.009392 -0.002610  0.006196  0.048436 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0152588  0.0020945   7.285 1.12e-10 ***
## avg_delayed 0.0018688  0.0002311   8.086 2.54e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01342 on 91 degrees of freedom
## Multiple R-squared:  0.4181, Adjusted R-squared:  0.4117 
## F-statistic: 65.39 on 1 and 91 DF,  p-value: 2.537e-12</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1">  <span class="co"># ggplot(aes(x = day, y = cancelled_perc))+</span></a>
<a class="sourceLine" id="cb292-2" title="2">  <span class="co"># geom_line()</span></a></code></pre></div>
<p>If you were confused by the <code>.</code> in <code>lm(cancelled_perc ~ avg_delayed, data = .)</code>, the dot specifies where the output from the prior steps should be piped into. The default is for it to go into the first argument, but for the <code>lm</code> function, data is not the first argument, so I have to explicitly tell it that the prior steps output should be inputted into the data argument of the <code>lm</code> function. See <a href="appendix-1.html#on-piping-dots">On piping dots</a> for more details.</p>
<p>The average delay accounts for 42% of the variation in the proportion of canceled flights.</p>
<p>Modeling the log-odds of the proportion of cancelled flights might be more successful as it produces a variable not constrained by 0 to 1, better aligning with the assumptions of linear regression.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">cancelled_mod2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb293-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb293-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb293-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb293-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb293-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num,</a>
<a class="sourceLine" id="cb293-7" title="7">            <span class="dt">cancelled_logodds =</span> <span class="kw">log</span>(cancelled <span class="op">/</span><span class="st"> </span>(num <span class="op">-</span><span class="st"> </span>cancelled))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb293-8" title="8"><span class="st">  </span><span class="kw">lm</span>(cancelled_logodds <span class="op">~</span><span class="st"> </span>avg_delayed, <span class="dt">data =</span> .)</a></code></pre></div>
<p>To convert logodds back to percentage, I built the following equation.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">convert_logodds &lt;-<span class="st"> </span><span class="cf">function</span>(log_odds) <span class="kw">exp</span>(log_odds) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(log_odds))</a></code></pre></div>
<p>Let’s calculate the MAE or mean absolute error on our percentages.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">cancelled_preds2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(origin, day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">cancelled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(arr_delay)),</a>
<a class="sourceLine" id="cb295-4" title="4">            <span class="dt">avg_delayed =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb295-5" title="5">            <span class="dt">num =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb295-6" title="6">            <span class="dt">cancelled_perc =</span> cancelled <span class="op">/</span><span class="st"> </span>num,</a>
<a class="sourceLine" id="cb295-7" title="7">            <span class="dt">cancelled_logodds =</span> <span class="kw">log</span>(cancelled <span class="op">/</span><span class="st"> </span>(num <span class="op">-</span><span class="st"> </span>cancelled))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-8" title="8"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-9" title="9"><span class="st">  </span>modelr<span class="op">::</span><span class="kw">spread_predictions</span>(cancelled_mod1, cancelled_mod2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cancelled_mod2 =</span> <span class="kw">convert_logodds</span>(cancelled_mod2))</a>
<a class="sourceLine" id="cb295-11" title="11"></a>
<a class="sourceLine" id="cb295-12" title="12">cancelled_preds2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-13" title="13"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MAE1 =</span> <span class="kw">mean</span>(<span class="kw">abs</span>(cancelled_perc <span class="op">-</span><span class="st"> </span>cancelled_mod1), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb295-14" title="14">            <span class="dt">MAE2 =</span> <span class="kw">mean</span>(<span class="kw">abs</span>(cancelled_perc <span class="op">-</span><span class="st"> </span>cancelled_mod2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb295-15" title="15">            <span class="dt">mean_value =</span> <span class="kw">mean</span>(cancelled_perc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##     MAE1    MAE2 mean_value
##    &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
## 1 0.0101 0.00954     0.0279</code></pre>
<p>Let’s look at the differences in the outputs of the predictions from these models.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1">cancelled_preds2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb297-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(avg_delayed, cancelled_perc))<span class="op">+</span></a>
<a class="sourceLine" id="cb297-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb297-4" title="4"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb297-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> cancelled_mod1), <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb297-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> cancelled_mod2), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
</div>
</div>
<div id="section-17" class="section level2">
<h2><span class="header-section-number">5.7</span> 5.6.7.6.</h2>
<p>As an example, let’s look at just Atl flights from LGA and compare DL, FL, MQ.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-2" title="2"><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &#39;ATL&#39;</span>, origin <span class="op">==</span><span class="st"> &#39;LGA&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="st">  </span><span class="kw">count</span>(carrier)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   carrier     n
##   &lt;chr&gt;   &lt;int&gt;
## 1 DL       5544
## 2 EV          1
## 3 FL       2337
## 4 MQ       2322
## 5 WN         59</code></pre>
<p>And compare the median delays between the three primary carriers DL, FL, MQ.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1">carriers_lga_atl &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-2" title="2"><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &#39;ATL&#39;</span>, origin <span class="op">==</span><span class="st"> &#39;LGA&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-4" title="4"><span class="st">  </span><span class="co"># filter out small samples</span></a>
<a class="sourceLine" id="cb300-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_tot =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-6" title="6"><span class="st">  </span><span class="kw">filter</span>(n_tot <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-7" title="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n_tot) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-8" title="8"><span class="st">  </span><span class="co">###</span></a>
<a class="sourceLine" id="cb300-9" title="9"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-10" title="10"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb300-11" title="11"></a>
<a class="sourceLine" id="cb300-12" title="12">label &lt;-<span class="st"> </span>carriers_lga_atl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-13" title="13"><span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-14" title="14"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">arr_delay =</span> <span class="kw">median</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb300-15" title="15"></a>
<a class="sourceLine" id="cb300-16" title="16">carriers_lga_atl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-17" title="17"><span class="st">  </span><span class="kw">select</span>(carrier, arr_delay) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-18" title="18"><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb300-19" title="19"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(carrier, arr_delay, <span class="dt">colour =</span> carrier), <span class="dt">outlier.shape =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb300-20" title="20"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">75</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb300-21" title="21"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carrier, <span class="dt">group =</span> carrier, <span class="dt">y =</span> arr_delay <span class="op">+</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">label =</span> arr_delay), <span class="dt">data =</span> label)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<p>Or perhaps you want to use a statistical method to compare if the differences in the grouped are significant…</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1">carriers_lga_atl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-2" title="2"><span class="st">  </span><span class="kw">lm</span>(arr_delay <span class="op">~</span><span class="st"> </span>carrier, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = arr_delay ~ carrier, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -64.74 -22.33 -11.33   4.67 888.67 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.3273     0.6149   10.29  &lt; 2e-16 ***
## carrierFL    14.4172     1.1340   12.71  &lt; 2e-16 ***
## carrierMQ     7.7067     1.1417    6.75 1.56e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 45.48 on 9979 degrees of freedom
## Multiple R-squared:  0.01692,    Adjusted R-squared:  0.01672 
## F-statistic: 85.86 on 2 and 9979 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This shows the mean delay for DL is ~6.3, FL is ~20.7, MQ is ~14 and FL and MQ are significantly different from DL (and DL is significantly different from 0)<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>. The carrier accouts for ~1.6% of the variation in arrival… etc….</p>
</div>
<div id="section-18" class="section level2">
<h2><span class="header-section-number">5.8</span> 5.7.1.6.</h2>
<p>Let’s look at the fastest 20 <code>air_time</code>s for each destination.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">min_rank =</span> <span class="kw">min_rank</span>(air_time)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-4" title="4"><span class="st">  </span><span class="kw">filter</span>(min_rank <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(distance, air_time, <span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb303-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb303-7" title="7"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>Let’s do the same for my custom <code>air_time</code> calculation <code>air_calc</code>.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">min_rank =</span> <span class="kw">min_rank</span>(air_calc)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-4" title="4"><span class="st">  </span><span class="kw">filter</span>(min_rank <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(distance, air_calc, <span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb304-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb304-7" title="7"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p><em>Rather than the fastest 20, let’s look at the mean <code>dist</code> and <code>air_time</code> for each<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.</em></p>
<p>First using the <code>air_time</code> value.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-2" title="2"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb305-3" title="3">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_air =</span> <span class="kw">mean</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb305-6" title="6">            <span class="dt">mean_dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> mean_dist, <span class="dt">y =</span> mean_air))<span class="op">+</span></a>
<a class="sourceLine" id="cb305-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb305-9" title="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">660</span>, <span class="dv">60</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb305-10" title="10"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>Then with the custom <code>air_calc</code>.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1">flights_new2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-2" title="2"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;arr_time&quot;</span>), </a>
<a class="sourceLine" id="cb307-3" title="3">            <span class="dt">.funs =</span> <span class="kw">funs</span>(time_to_mins)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_air =</span> <span class="kw">mean</span>(air_calc, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb307-6" title="6">            <span class="dt">mean_dist =</span> <span class="kw">mean</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> mean_dist, <span class="dt">y =</span> mean_air))<span class="op">+</span></a>
<a class="sourceLine" id="cb307-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> dest))<span class="op">+</span></a>
<a class="sourceLine" id="cb307-9" title="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">660</span>, <span class="dv">60</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb307-10" title="10"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
<div id="section-19" class="section level2">
<h2><span class="header-section-number">5.9</span> 5.7.1.5</h2>
<p>Let’s run this for every 3 lags (1, 4, 7, …) and plot.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1">lags_cors &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">lag =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cor =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(lag, cor_by_lag))</a>
<a class="sourceLine" id="cb309-3" title="3"></a>
<a class="sourceLine" id="cb309-4" title="4">lags_cors <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lag, cor))<span class="op">+</span></a>
<a class="sourceLine" id="cb309-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb309-7" title="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.40</span>))</a></code></pre></div>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
</div>
<div id="section-20" class="section level2">
<h2><span class="header-section-number">5.10</span> 5.7.1.8.</h2>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1">tail_nums_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-2" title="2"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-3" title="3"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-4" title="4"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-5" title="5"><span class="st">  </span><span class="kw">View</span>()</a></code></pre></div>
</div>
<div id="other" class="section level2">
<h2><span class="header-section-number">5.11</span> Other</h2>
<div id="on-piping-dots" class="section level3">
<h3><span class="header-section-number">5.11.1</span> On piping dots</h3>
<p>The <code>.</code> let’s you explicitly state where to pipe the output from the prior steps. The default is to have it go into the first argument of the function.</p>
<p><em>Let’s look at an example:</em></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-3" title="3"><span class="st">  </span><span class="kw">count</span>(origin)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   origin      n
##   &lt;chr&gt;   &lt;int&gt;
## 1 EWR    117127
## 2 JFK    109079
## 3 LGA    101140</code></pre>
<p>This is the exact same thing as the code below, I just added the dots to be explicit about where in the function the output from the prior steps will go:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="st">  </span><span class="kw">filter</span>(., <span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb313-3" title="3"><span class="st">  </span><span class="kw">count</span>(., origin)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   origin      n
##   &lt;chr&gt;   &lt;int&gt;
## 1 EWR    117127
## 2 JFK    109079
## 3 LGA    101140</code></pre>
<p>Functions in dplyr, etc. expect dataframes in the first argument, so the default piping behavior works fine you don’t end-up using the dot in this way. However functions outside of the tidyverse are not always so consistent and may expect the dataframe (or w/e your output from the prior step is) in a different location of the function, hence the need to use the dot to specify where it should go.</p>
<p>The example below uses base R’s <code>lm</code> (linear models) function to regress <code>arr_delay</code> on <code>dep_delay</code> and <code>distance</code><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>. The first argument expects a function, the second argument the data, hence the need for the dot.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb315-2" title="2"><span class="st">  </span><span class="kw">filter</span>(., <span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb315-3" title="3"><span class="st">  </span><span class="kw">lm</span>(arr_delay <span class="op">~</span><span class="st"> </span>dep_delay <span class="op">+</span><span class="st"> </span>distance, .) </a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = arr_delay ~ dep_delay + distance, data = .)
## 
## Coefficients:
## (Intercept)    dep_delay     distance  
##   -3.212779     1.018077    -0.002551</code></pre>
<p>When using the <code>.</code> in piping, I will usually make the argment name I am piping into explicit. This makes it more clear and also means if I have the position order wrong it doesn’t matter.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb317-2" title="2"><span class="st">  </span><span class="kw">filter</span>(., <span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb317-3" title="3"><span class="st">  </span><span class="kw">lm</span>(arr_delay <span class="op">~</span><span class="st"> </span>dep_delay <span class="op">+</span><span class="st"> </span>distance, <span class="dt">data =</span> .)</a></code></pre></div>
<p>You can also use the <code>.</code> in conjunction with R’s subsetting to output vectors. In the example below I filter flights, then extract the <code>arr_delay</code> column as a vector and pipe it into the base R function <code>quantile</code>.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb318-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb318-3" title="3"><span class="st">  </span>.<span class="op">$</span>arr_delay <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb318-4" title="4"><span class="st">  </span><span class="kw">quantile</span>(<span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.10</span>))</a></code></pre></div>
<pre><code>##   0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
##  -86  -26  -19  -14  -10   -5    1    9   21   52 1272</code></pre>
<p><code>quantile</code> is expecting a numeric vector in it’s first argument so the above works. If instead of <code>.$arr_delay</code>, you’d tried <code>select(arr_delay</code>) the function would have failed because the <code>select</code> statement outputs a dataframe rather than a vector (and <code>quantile</code> would have become very angry with you). One weakness with the above method is it only allows you to input a single vector into the base R function (while many funcitons can take in multiple vectors).</p>
<p>A better way of doing this is to use the <code>with</code> function. The <code>with</code> function allows you to pipe a dataframe into the first argument and then reference the column in that dataframe with just the field names. This makes using those base R funcitons easier and more similar in syntax to tidyverse functions. For example, the above example would look become.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb320-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb320-3" title="3"><span class="st">  </span><span class="kw">with</span>(<span class="kw">quantile</span>(arr_delay, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.10</span>)))</a></code></pre></div>
<pre><code>##   0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
##  -86  -26  -19  -14  -10   -5    1    9   21   52 1272</code></pre>
<p>This method also makes it easy to input multiple field names in this style. Let’s look at this with the <code>table</code> function<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(arr_delay)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-3" title="3"><span class="st">  </span><span class="kw">with</span>(<span class="kw">table</span>(origin, carrier))</a></code></pre></div>
<pre><code>##       carrier
## origin    9E    AA    AS    B6    DL    EV    F9    FL    HA    MQ    OO
##    EWR  1193  3363   709  6472  4295 41557     0     0     0  2097     6
##    JFK 13742 13600     0 41666 20559  1326     0     0   342  6838     0
##    LGA  2359 14984     0  5911 22804  8225   681  3175     0 16102    23
##       carrier
## origin    UA    US    VX    WN    YV
##    EWR 45501  4326  1552  6056     0
##    JFK  4478  2964  3564     0     0
##    LGA  7803 12541     0  5988   544</code></pre>
</div>
</div>
<div id="plotly" class="section level2">
<h2><span class="header-section-number">5.12</span> plotly</h2>
<p>the <code>plotly</code> package has a cool function <code>ggplotly</code> that allows you to add wrappers <code>ggplot</code> that turn it into html that allow you to do things like zoom-in and hover over points. It also has a <code>frame</code> argument that allows you to make animations or filter between points. Here is an example from the <code>flights</code> dataset.</p>
<p>Note that this will not render in a markdown format, but only in html.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1">p &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(hour, month) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> avg_delay, <span class="dt">group =</span> month, <span class="dt">frame =</span> month))<span class="op">+</span></a>
<a class="sourceLine" id="cb324-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb324-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>()</a>
<a class="sourceLine" id="cb324-7" title="7"></a>
<a class="sourceLine" id="cb324-8" title="8">plotly<span class="op">::</span><span class="kw">ggplotly</span>(p)</a></code></pre></div>
<p>This is the base from which this is built.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(hour, month) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> avg_delay, <span class="dt">group =</span> month))<span class="op">+</span></a>
<a class="sourceLine" id="cb325-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb325-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="05-data-transformations_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>

<p><em>Make sure the following packages are installed:</em></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>This method is helpful for if you have more than ust a couple variables you are applying a transformation to.<a href="appendix-1.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p> Linear regression is used here which aren’t learned until later in the book though.<a href="appendix-1.html#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>The mutate step that is commented-out would reorder the <code>delays_q</code> variable according to the mean value of the <code>delays_val</code>, but this is not necessary here so I commented it out. You will learn more about this in the factors chapter.lm<a href="appendix-1.html#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>The names assigned by the <code>quantile</code> function are a little different from those I supplied.<a href="appendix-1.html#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p>Another approach may be to try and identify the individual risk of having a flight cancelled based on the average delay. If this is the case, you may want to use model evaluation techniques that seperate models based on the assigned probabilities in which case MAE may actually not be the most appropriate evaluation technique. You could try using logistic regression for this. You may also consider taking into account the weight of each of the points. I had discussions on these, but decided they were too in the weeds so deleted them even from the appendix…<a href="appendix-1.html#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>Repeated t-test methods could be used for comparing MQ and FL, see function <code>pairwise.t.test</code><a href="appendix-1.html#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p>Each colour corresponds with a <code>dest</code> though I excluded the legend.<a href="appendix-1.html#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p>You may want to add a step to pipe this into <code>summary()</code> after the <code>lm</code> step as well.<a href="appendix-1.html#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p><code>table</code> produces contingency tables.<a href="appendix-1.html#fnref13" class="footnote-back">↩</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//brshallo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the
<a href="https://disqus.com/?ref_noscript">
  comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="ch-5-data-transformations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-7-data-exploration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"split_by": "rmd",
"number_sections": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
